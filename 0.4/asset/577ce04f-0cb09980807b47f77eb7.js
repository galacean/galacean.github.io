(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{w8pg:function(t,e,a){a("4n65"),a("mNHV"),function(t,e){"use strict";function a(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,a){return e&&r(t.prototype,e),a&&r(t,a),t}function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?h(t):e}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=l(t);if(e){var r=l(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u(this,a)}}function d(t,e,a,n){a&&Object.defineProperty(t,e,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(n):void 0})}function f(t,e,a,n,r){var i={};return Object.keys(n).forEach((function(t){i[t]=n[t]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=a.slice().reverse().reduce((function(a,n){return n(t,e,a)||a}),i),r&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(r):void 0,i.initializer=void 0),void 0===i.initializer&&(Object.defineProperty(t,e,i),i=null),i}var v=function(){function t(){n(this,t),this.array=new Array}return i(t,[{key:"add",value:function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e}},{key:"contains",value:function(t){return null!=this.array[0|t]}},{key:"remove",value:function(t){this.array[0|t]=void 0}},{key:"clear",value:function(){this.array.length=0}}]),t}(),g=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n(this,t),this.r=e,this.g=a,this.b=r,this.a=i}return i(t,[{key:"set",value:function(t,e,a,n){return this.r=t,this.g=e,this.b=a,this.a=n,this.clamp(),this}},{key:"setFromColor",value:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}},{key:"setFromString",value:function(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=(8!=t.length?255:parseInt(t.substr(6,2),16))/255,this}},{key:"add",value:function(t,e,a,n){return this.r+=t,this.g+=e,this.b+=a,this.a+=n,this.clamp(),this}},{key:"clamp",value:function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}}],[{key:"rgba8888ToColor",value:function(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}},{key:"rgb888ToColor",value:function(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}}]),t}();g.WHITE=new g(1,1,1,1),g.RED=new g(1,0,0,1),g.GREEN=new g(0,1,0,1),g.BLUE=new g(0,0,1,1),g.MAGENTA=new g(1,0,1,1);var m=function(){function t(){n(this,t)}return i(t,null,[{key:"clamp",value:function(t,e,a){return t<e?e:t>a?a:t}},{key:"cosDeg",value:function(e){return Math.cos(e*t.degRad)}},{key:"sinDeg",value:function(e){return Math.sin(e*t.degRad)}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}},{key:"toInt",value:function(t){return t>0?Math.floor(t):Math.ceil(t)}},{key:"cbrt",value:function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}},{key:"randomTriangular",value:function(e,a){return t.randomTriangularWith(e,a,.5*(e+a))}},{key:"randomTriangularWith",value:function(t,e,a){var n=Math.random(),r=e-t;return n<=(a-t)/r?t+Math.sqrt(n*r*(a-t)):e-Math.sqrt((1-n)*r*(e-a))}}]),t}();m.PI=3.1415927,m.PI2=2*m.PI,m.radiansToDegrees=180/m.PI,m.radDeg=m.radiansToDegrees,m.degreesToRadians=m.PI/180,m.degRad=m.degreesToRadians;var p=function(){function t(){n(this,t)}return i(t,null,[{key:"arrayCopy",value:function(t,e,a,n,r){for(var i=e,s=n;i<e+r;i++,s++)a[s]=t[i]}},{key:"setArraySize",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t.length;if(n==e)return t;if(t.length=e,n<e)for(var r=n;r<e;r++)t[r]=a;return t}},{key:"ensureArrayCapacity",value:function(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.length>=a?e:t.setArraySize(e,a,n)}},{key:"newArray",value:function(t,e){for(var a=new Array(t),n=0;n<t;n++)a[n]=e;return a}},{key:"newFloatArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);for(var a=new Array(e),n=0;n<a.length;n++)a[n]=0;return a}},{key:"newShortArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);for(var a=new Array(e),n=0;n<a.length;n++)a[n]=0;return a}},{key:"toFloatArray",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e}},{key:"toSinglePrecision",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e}},{key:"webkit602BugfixHelper",value:function(t,e){}},{key:"contains",value:function(t,e){for(var a=0;a<t.length;a++)if(t[a]==e)return!0;return!1}}]),t}();p.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array;var y,w=function(){function t(e){n(this,t),this.items=new Array,this.instantiator=void 0,this.instantiator=e}return i(t,[{key:"obtain",value:function(){return this.items.length>0?this.items.pop():this.instantiator()}},{key:"free",value:function(t){t.reset&&t.reset(),this.items.push(t)}},{key:"freeAll",value:function(t){for(var e=0;e<t.length;e++)this.free(t[e])}},{key:"clear",value:function(){this.items.length=0}}]),t}(),k=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n(this,t),this.x=e,this.y=a}return i(t,[{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"length",value:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}},{key:"normalize",value:function(){var t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this}}]),t}(),E=function t(e,a,r){if(n(this,t),this.index=void 0,this.name=void 0,this.parent=void 0,this.length=void 0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=y.Normal,this.skinRequired=!1,this.color=new g,e<0)throw new Error("index must be >= 0.");if(null==a)throw new Error("name cannot be null.");this.index=e,this.name=a,this.parent=r};!function(t){t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection"}(y||(y={}));var x,b,M,S=function(){function t(e,a,r){if(n(this,t),this.data=void 0,this.skeleton=void 0,this.parent=void 0,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,null==e)throw new Error("data cannot be null.");if(null==a)throw new Error("skeleton cannot be null.");this.data=e,this.skeleton=a,this.parent=r,this.setToSetupPose()}return i(t,[{key:"isActive",value:function(){return this.active}},{key:"update",value:function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}},{key:"updateWorldTransform",value:function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}},{key:"updateWorldTransformWith",value:function(t,e,a,n,r,i,s){this.ax=t,this.ay=e,this.arotation=a,this.ascaleX=n,this.ascaleY=r,this.ashearX=i,this.ashearY=s,this.appliedValid=!0;var o=this.parent;if(null==o){var l=this.skeleton,h=a+90+s,u=l.scaleX,c=l.scaleY;return this.a=m.cosDeg(a+i)*n*u,this.b=m.cosDeg(h)*r*u,this.c=m.sinDeg(a+i)*n*c,this.d=m.sinDeg(h)*r*c,this.worldX=t*u+l.x,void(this.worldY=e*c+l.y)}var d=o.a,f=o.b,v=o.c,g=o.d;switch(this.worldX=d*t+f*e+o.worldX,this.worldY=v*t+g*e+o.worldY,this.data.transformMode){case y.Normal:var p=a+90+s,w=m.cosDeg(a+i)*n,k=m.cosDeg(p)*r,E=m.sinDeg(a+i)*n,x=m.sinDeg(p)*r;return this.a=d*w+f*E,this.b=d*k+f*x,this.c=v*w+g*E,void(this.d=v*k+g*x);case y.OnlyTranslation:var b=a+90+s;this.a=m.cosDeg(a+i)*n,this.b=m.cosDeg(b)*r,this.c=m.sinDeg(a+i)*n,this.d=m.sinDeg(b)*r;break;case y.NoRotationOrReflection:var M=d*d+v*v,S=0;M>1e-4?(M=Math.abs(d*g-f*v)/M,d/=this.skeleton.scaleX,f=(v/=this.skeleton.scaleY)*M,g=d*M,S=Math.atan2(v,d)*m.radDeg):(d=0,v=0,S=90-Math.atan2(g,f)*m.radDeg);var I=a+i-S,A=a+s-S+90,T=m.cosDeg(I)*n,R=m.cosDeg(A)*r,C=m.sinDeg(I)*n,V=m.sinDeg(A)*r;this.a=d*T-f*C,this.b=d*R-f*V,this.c=v*T+g*C,this.d=v*R+g*V;break;case y.NoScale:case y.NoScaleOrReflection:var P=m.cosDeg(a),F=m.sinDeg(a),N=(d*P+f*F)/this.skeleton.scaleX,_=(v*P+g*F)/this.skeleton.scaleY,O=Math.sqrt(N*N+_*_);O>1e-5&&(O=1/O),N*=O,_*=O,O=Math.sqrt(N*N+_*_),this.data.transformMode==y.NoScale&&d*g-f*v<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(O=-O);var L=Math.PI/2+Math.atan2(_,N),D=Math.cos(L)*O,X=Math.sin(L)*O,Y=m.cosDeg(i)*n,B=m.cosDeg(90+s)*r,U=m.sinDeg(i)*n,W=m.sinDeg(90+s)*r;this.a=N*Y+D*U,this.b=N*B+D*W,this.c=_*Y+X*U,this.d=_*B+X*W}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}},{key:"setToSetupPose",value:function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}},{key:"getWorldRotationX",value:function(){return Math.atan2(this.c,this.a)*m.radDeg}},{key:"getWorldRotationY",value:function(){return Math.atan2(this.d,this.b)*m.radDeg}},{key:"getWorldScaleX",value:function(){return Math.sqrt(this.a*this.a+this.c*this.c)}},{key:"getWorldScaleY",value:function(){return Math.sqrt(this.b*this.b+this.d*this.d)}},{key:"updateAppliedTransform",value:function(){this.appliedValid=!0;var t=this.parent;if(null==t)return this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*m.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*m.radDeg);var e=t.a,a=t.b,n=t.c,r=t.d,i=1/(e*r-a*n),s=this.worldX-t.worldX,o=this.worldY-t.worldY;this.ax=s*r*i-o*a*i,this.ay=o*e*i-s*n*i;var l=i*r,h=i*e,u=i*a,c=i*n,d=l*this.a-u*this.c,f=l*this.b-u*this.d,v=h*this.c-c*this.a,g=h*this.d-c*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(d*d+v*v),this.ascaleX>1e-4){var p=d*g-f*v;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(d*f+v*g,p)*m.radDeg,this.arotation=Math.atan2(v,d)*m.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(f*f+g*g),this.ashearY=0,this.arotation=90-Math.atan2(g,f)*m.radDeg}},{key:"worldToLocal",value:function(t){var e=this.a,a=this.b,n=this.c,r=this.d,i=1/(e*r-a*n),s=t.x-this.worldX,o=t.y-this.worldY;return t.x=s*r*i-o*a*i,t.y=o*e*i-s*n*i,t}},{key:"localToWorld",value:function(t){var e=t.x,a=t.y;return t.x=e*this.a+a*this.b+this.worldX,t.y=e*this.c+a*this.d+this.worldY,t}},{key:"worldToLocalRotation",value:function(t){var e=m.sinDeg(t),a=m.cosDeg(t);return Math.atan2(this.a*e-this.c*a,this.d*a-this.b*e)*m.radDeg+this.rotation-this.shearX}},{key:"localToWorldRotation",value:function(t){t-=this.rotation-this.shearX;var e=m.sinDeg(t),a=m.cosDeg(t);return Math.atan2(a*this.c+e*this.d,a*this.a+e*this.b)*m.radDeg}},{key:"rotateWorld",value:function(t){var e=this.a,a=this.b,n=this.c,r=this.d,i=m.cosDeg(t),s=m.sinDeg(t);this.a=i*e-s*n,this.b=i*a-s*r,this.c=s*e+i*n,this.d=s*a+i*r,this.appliedValid=!1}}]),t}(),I=function(){function t(e,a){if(n(this,t),this.data=void 0,this.bone=void 0,this.color=void 0,this.darkColor=void 0,this.attachment=void 0,this.attachmentTime=void 0,this.attachmentState=void 0,this.deform=new Array,null==e)throw new Error("data cannot be null.");if(null==a)throw new Error("bone cannot be null.");this.data=e,this.bone=a,this.color=new g,this.darkColor=null==e.darkColor?null:new g,this.setToSetupPose()}return i(t,[{key:"getSkeleton",value:function(){return this.bone.skeleton}},{key:"getAttachment",value:function(){return this.attachment}},{key:"setAttachment",value:function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)}},{key:"setAttachmentTime",value:function(t){this.attachmentTime=this.bone.skeleton.time-t}},{key:"getAttachmentTime",value:function(){return this.bone.skeleton.time-this.attachmentTime}},{key:"setToSetupPose",value:function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}}]),t}(),A=function(){function t(e,a){if(n(this,t),this.data=void 0,this.bones=void 0,this.target=void 0,this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,null==e)throw new Error("data cannot be null.");if(null==a)throw new Error("skeleton cannot be null.");this.data=e,this.mix=e.mix,this.softness=e.softness,this.bendDirection=e.bendDirection,this.compress=e.compress,this.stretch=e.stretch,this.bones=new Array;for(var r=0;r<e.bones.length;r++)this.bones.push(a.findBone(e.bones[r].name));this.target=a.findBone(e.target.name)}return i(t,[{key:"isActive",value:function(){return this.active}},{key:"apply",value:function(){this.update()}},{key:"update",value:function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix)}}},{key:"apply1",value:function(t,e,a,n,r,i,s){t.appliedValid||t.updateAppliedTransform();var o=t.parent,l=o.a,h=o.b,u=o.c,c=o.d,d=-t.ashearX-t.arotation,f=0,v=0;switch(t.data.transformMode){case y.OnlyTranslation:f=e-t.worldX,v=a-t.worldY;break;case y.NoRotationOrReflection:var g=Math.abs(l*c-h*u)/(l*l+u*u),p=l/t.skeleton.scaleX,w=u/t.skeleton.scaleY;h=-w*g*t.skeleton.scaleX,c=p*g*t.skeleton.scaleY,d+=Math.atan2(w,p)*m.radDeg;default:var k=e-o.worldX,E=a-o.worldY,x=l*c-h*u;f=(k*c-E*h)/x-t.ax,v=(E*l-k*u)/x-t.ay}d+=Math.atan2(v,f)*m.radDeg,t.ascaleX<0&&(d+=180),d>180?d-=360:d<-180&&(d+=360);var b=t.ascaleX,M=t.ascaleY;if(n||r){switch(t.data.transformMode){case y.NoScale:case y.NoScaleOrReflection:f=e-t.worldX,v=a-t.worldY}var S=t.data.length*b,I=Math.sqrt(f*f+v*v);if(n&&I<S||r&&I>S&&S>1e-4){var A=(I/S-1)*s+1;b*=A,i&&(M*=A)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+d*s,b,M,t.ashearX,t.ashearY)}},{key:"apply2",value:function(t,e,a,n,r,i,s,o){if(0!=o){t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();var l=t.ax,h=t.ay,u=t.ascaleX,c=u,d=t.ascaleY,f=e.ascaleX,v=0,g=0,p=0;u<0?(u=-u,v=180,p=-1):(v=0,p=1),d<0&&(d=-d,p=-p),f<0?(f=-f,g=180):g=0;var y=e.ax,w=0,k=0,E=0,x=t.a,b=t.b,M=t.c,S=t.d,I=Math.abs(u-d)<=1e-4;I?(k=x*y+b*(w=e.ay)+t.worldX,E=M*y+S*w+t.worldY):(w=0,k=x*y+t.worldX,E=M*y+t.worldY);var A=t.parent;x=A.a,b=A.b,M=A.c;var T,R,C=1/(x*(S=A.d)-b*M),V=k-A.worldX,P=E-A.worldY,F=(V*S-P*b)*C-l,N=(P*x-V*M)*C-h,_=Math.sqrt(F*F+N*N),O=e.data.length*f;if(_<1e-4)return this.apply1(t,a,n,!1,i,!1,o),void e.updateWorldTransformWith(y,w,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);var L=((V=a-A.worldX)*S-(P=n-A.worldY)*b)*C-l,D=(P*x-V*M)*C-h,X=L*L+D*D;if(0!=s){s*=u*(f+1)/2;var Y=Math.sqrt(X),B=Y-_-O*u+s;if(B>0){var U=Math.min(1,B/(2*s))-1;X=(L-=(U=(B-s*(1-U*U))/Y)*L)*L+(D-=U*D)*D}}t:if(I){var W=(X-_*_-(O*=u)*O)/(2*_*O);W<-1?W=-1:W>1&&(W=1,i&&(c*=(Math.sqrt(X)/(_+O)-1)*o+1)),R=Math.acos(W)*r,x=_+O*W,b=O*Math.sin(R),T=Math.atan2(D*x-L*b,L*x+D*b)}else{var q=(x=u*O)*x,H=(b=d*O)*b,j=Math.atan2(D,L),G=-2*H*_,z=H-q;if((S=G*G-4*z*(M=H*_*_+q*X-q*H))>=0){var Z=Math.sqrt(S);G<0&&(Z=-Z);var Q=(Z=-(G+Z)/2)/z,J=M/Z,K=Math.abs(Q)<Math.abs(J)?Q:J;if(K*K<=X){P=Math.sqrt(X-K*K)*r,T=j-Math.atan2(P,K),R=Math.atan2(P/d,(K-_)/u);break t}}var $=m.PI,tt=_-x,et=tt*tt,at=0,nt=0,rt=_+x,it=rt*rt,st=0;(M=-x*_/(q-H))>=-1&&M<=1&&(M=Math.acos(M),(S=(V=x*Math.cos(M)+_)*V+(P=b*Math.sin(M))*P)<et&&($=M,et=S,tt=V,at=P),S>it&&(nt=M,it=S,rt=V,st=P)),X<=(et+it)/2?(T=j-Math.atan2(at*r,tt),R=$*r):(T=j-Math.atan2(st*r,rt),R=nt*r)}var ot=Math.atan2(w,y)*p,lt=t.arotation;(T=(T-ot)*m.radDeg+v-lt)>180?T-=360:T<-180&&(T+=360),t.updateWorldTransformWith(l,h,lt+T*o,c,t.ascaleY,0,0),lt=e.arotation,(R=((R+ot)*m.radDeg-e.ashearX)*p+g-lt)>180?R-=360:R<-180&&(R+=360),e.updateWorldTransformWith(y,w,lt+R*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}else e.updateWorldTransform()}}]),t}(),T=function(){function t(e,a){if(n(this,t),this.data=void 0,this.bones=void 0,this.target=void 0,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new k,this.active=!1,null==e)throw new Error("data cannot be null.");if(null==a)throw new Error("skeleton cannot be null.");this.data=e,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.scaleMix=e.scaleMix,this.shearMix=e.shearMix,this.bones=new Array;for(var r=0;r<e.bones.length;r++)this.bones.push(a.findBone(e.bones[r].name));this.target=a.findBone(e.target.name)}return i(t,[{key:"isActive",value:function(){return this.active}},{key:"apply",value:function(){this.update()}},{key:"update",value:function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}},{key:"applyAbsoluteWorld",value:function(){for(var t=this.rotateMix,e=this.translateMix,a=this.scaleMix,n=this.shearMix,r=this.target,i=r.a,s=r.b,o=r.c,l=r.d,h=i*l-s*o>0?m.degRad:-m.degRad,u=this.data.offsetRotation*h,c=this.data.offsetShearY*h,d=this.bones,f=0,v=d.length;f<v;f++){var g=d[f],p=!1;if(0!=t){var y=g.a,w=g.b,k=g.c,E=g.d,x=Math.atan2(o,i)-Math.atan2(k,y)+u;x>m.PI?x-=m.PI2:x<-m.PI&&(x+=m.PI2),x*=t;var b=Math.cos(x),M=Math.sin(x);g.a=b*y-M*k,g.b=b*w-M*E,g.c=M*y+b*k,g.d=M*w+b*E,p=!0}if(0!=e){var S=this.temp;r.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),g.worldX+=(S.x-g.worldX)*e,g.worldY+=(S.y-g.worldY)*e,p=!0}if(a>0){var I=Math.sqrt(g.a*g.a+g.c*g.c),A=Math.sqrt(i*i+o*o);I>1e-5&&(I=(I+(A-I+this.data.offsetScaleX)*a)/I),g.a*=I,g.c*=I,I=Math.sqrt(g.b*g.b+g.d*g.d),A=Math.sqrt(s*s+l*l),I>1e-5&&(I=(I+(A-I+this.data.offsetScaleY)*a)/I),g.b*=I,g.d*=I,p=!0}if(n>0){var T=g.b,R=g.d,C=Math.atan2(R,T),V=Math.atan2(l,s)-Math.atan2(o,i)-(C-Math.atan2(g.c,g.a));V>m.PI?V-=m.PI2:V<-m.PI&&(V+=m.PI2),V=C+(V+c)*n;var P=Math.sqrt(T*T+R*R);g.b=Math.cos(V)*P,g.d=Math.sin(V)*P,p=!0}p&&(g.appliedValid=!1)}}},{key:"applyRelativeWorld",value:function(){for(var t=this.rotateMix,e=this.translateMix,a=this.scaleMix,n=this.shearMix,r=this.target,i=r.a,s=r.b,o=r.c,l=r.d,h=i*l-s*o>0?m.degRad:-m.degRad,u=this.data.offsetRotation*h,c=this.data.offsetShearY*h,d=this.bones,f=0,v=d.length;f<v;f++){var g=d[f],p=!1;if(0!=t){var y=g.a,w=g.b,k=g.c,E=g.d,x=Math.atan2(o,i)+u;x>m.PI?x-=m.PI2:x<-m.PI&&(x+=m.PI2),x*=t;var b=Math.cos(x),M=Math.sin(x);g.a=b*y-M*k,g.b=b*w-M*E,g.c=M*y+b*k,g.d=M*w+b*E,p=!0}if(0!=e){var S=this.temp;r.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),g.worldX+=S.x*e,g.worldY+=S.y*e,p=!0}if(a>0){var I=(Math.sqrt(i*i+o*o)-1+this.data.offsetScaleX)*a+1;g.a*=I,g.c*=I,I=(Math.sqrt(s*s+l*l)-1+this.data.offsetScaleY)*a+1,g.b*=I,g.d*=I,p=!0}if(n>0){var A=Math.atan2(l,s)-Math.atan2(o,i);A>m.PI?A-=m.PI2:A<-m.PI&&(A+=m.PI2);var T=g.b,R=g.d;A=Math.atan2(R,T)+(A-m.PI/2+c)*n;var C=Math.sqrt(T*T+R*R);g.b=Math.cos(A)*C,g.d=Math.sin(A)*C,p=!0}p&&(g.appliedValid=!1)}}},{key:"applyAbsoluteLocal",value:function(){var t=this.rotateMix,e=this.translateMix,a=this.scaleMix,n=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();for(var i=this.bones,s=0,o=i.length;s<o;s++){var l=i[s];l.appliedValid||l.updateAppliedTransform();var h=l.arotation;if(0!=t){var u=r.arotation-h+this.data.offsetRotation;h+=(u-=360*(16384-(16384.499999999996-u/360|0)))*t}var c=l.ax,d=l.ay;0!=e&&(c+=(r.ax-c+this.data.offsetX)*e,d+=(r.ay-d+this.data.offsetY)*e);var f=l.ascaleX,v=l.ascaleY;0!=a&&(f>1e-5&&(f=(f+(r.ascaleX-f+this.data.offsetScaleX)*a)/f),v>1e-5&&(v=(v+(r.ascaleY-v+this.data.offsetScaleY)*a)/v));var g=l.ashearY;if(0!=n){var m=r.ashearY-g+this.data.offsetShearY;m-=360*(16384-(16384.499999999996-m/360|0)),l.shearY+=m*n}l.updateWorldTransformWith(c,d,h,f,v,l.ashearX,g)}}},{key:"applyRelativeLocal",value:function(){var t=this.rotateMix,e=this.translateMix,a=this.scaleMix,n=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();for(var i=this.bones,s=0,o=i.length;s<o;s++){var l=i[s];l.appliedValid||l.updateAppliedTransform();var h=l.arotation;0!=t&&(h+=(r.arotation+this.data.offsetRotation)*t);var u=l.ax,c=l.ay;0!=e&&(u+=(r.ax+this.data.offsetX)*e,c+=(r.ay+this.data.offsetY)*e);var d=l.ascaleX,f=l.ascaleY;0!=a&&(d>1e-5&&(d*=(r.ascaleX-1+this.data.offsetScaleX)*a+1),f>1e-5&&(f*=(r.ascaleY-1+this.data.offsetScaleY)*a+1));var v=l.ashearY;0!=n&&(v+=(r.ashearY+this.data.offsetShearY)*n),l.updateWorldTransformWith(u,c,h,d,f,l.ashearX,v)}}}]),t}(),R=function t(e,a,r){n(this,t),this.name=e,this.order=a,this.skinRequired=r},C=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t,0,!1)).bones=new Array,r.target=void 0,r.positionMode=void 0,r.spacingMode=void 0,r.rotateMode=void 0,r.offsetRotation=void 0,r.position=void 0,r.spacing=void 0,r.rotateMix=void 0,r.translateMix=void 0,r}return a}(R);!function(t){t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent"}(x||(x={})),function(t){t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent"}(b||(b={})),function(t){t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale"}(M||(M={}));var V=function t(e){if(n(this,t),this.name=void 0,null==e)throw new Error("name cannot be null.");this.name=e},P=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).id=(65535&a.nextID++)<<11,r.bones=void 0,r.vertices=void 0,r.worldVerticesLength=0,r.deformAttachment=h(r),r}return i(a,[{key:"computeWorldVertices",value:function(t,e,a,n,r,i){a=r+(a>>1)*i;var s=t.bone.skeleton,o=t.deform,l=this.vertices,h=this.bones;if(null!=h){for(var u=0,c=0,d=0;d<e;d+=2){var f=h[u];u+=f+1,c+=f}var v=s.bones;if(0==o.length)for(var g=r,m=3*c;g<a;g+=i){var p=0,y=0,w=h[u++];for(w+=u;u<w;u++,m+=3){var k=v[h[u]],E=l[m],x=l[m+1],b=l[m+2];p+=(E*k.a+x*k.b+k.worldX)*b,y+=(E*k.c+x*k.d+k.worldY)*b}n[g]=p,n[g+1]=y}else for(var M=o,S=r,I=3*c,A=c<<1;S<a;S+=i){var T=0,R=0,C=h[u++];for(C+=u;u<C;u++,I+=3,A+=2){var V=v[h[u]],P=l[I]+M[A],F=l[I+1]+M[A+1],N=l[I+2];T+=(P*V.a+F*V.b+V.worldX)*N,R+=(P*V.c+F*V.d+V.worldY)*N}n[S]=T,n[S+1]=R}}else{o.length>0&&(l=o);for(var _=t.bone,O=_.worldX,L=_.worldY,D=_.a,X=_.b,Y=_.c,B=_.d,U=e,W=r;W<a;U+=2,W+=i){var q=l[U],H=l[U+1];n[W]=q*D+H*X+O,n[W+1]=q*Y+H*B+L}}}},{key:"copyTo",value:function(t){null!=this.bones?(t.bones=new Array(this.bones.length),p.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,null!=this.vertices?(t.vertices=p.newFloatArray(this.vertices.length),p.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)):t.vertices=null,t.worldVerticesLength=this.worldVerticesLength,t.deformAttachment=this.deformAttachment}}]),a}(V);P.nextID=0;var F=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).lengths=void 0,r.closed=!1,r.constantSpeed=!1,r.color=new g(1,1,1,1),r}return i(a,[{key:"copy",value:function(){var t=new a(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),p.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}]),a}(P),N=function(){function t(e,a){if(n(this,t),this.data=void 0,this.bones=void 0,this.target=void 0,this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,null==e)throw new Error("data cannot be null.");if(null==a)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(var r=0,i=e.bones.length;r<i;r++)this.bones.push(a.findBone(e.bones[r].name));this.target=a.findSlot(e.target.name),this.position=e.position,this.spacing=e.spacing,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix}return i(t,[{key:"isActive",value:function(){return this.active}},{key:"apply",value:function(){this.update()}},{key:"update",value:function(){var e=this.target.getAttachment();if(e instanceof F){var a=this.rotateMix,n=this.translateMix,r=a>0;if(n>0||r){var i=this.data,s=i.spacingMode==b.Percent,o=i.rotateMode,l=o==M.Tangent,h=o==M.ChainScale,u=this.bones.length,c=l?u:u+1,d=this.bones,f=p.setArraySize(this.spaces,c),v=null,g=this.spacing;if(h||!s){h&&(v=p.setArraySize(this.lengths,u));for(var y=i.spacingMode==b.Length,w=0,k=c-1;w<k;){var E=d[w],S=E.data.length;if(S<t.epsilon)h&&(v[w]=0),f[++w]=0;else if(s){if(h){var I=S*E.a,A=S*E.c,T=Math.sqrt(I*I+A*A);v[w]=T}f[++w]=g}else{var R=S*E.a,C=S*E.c,V=Math.sqrt(R*R+C*C);h&&(v[w]=V),f[++w]=(y?S+g:g)*V/S}}}else for(var P=1;P<c;P++)f[P]=g;var N=this.computeWorldPositions(e,c,l,i.positionMode==x.Percent,s),_=N[0],O=N[1],L=i.offsetRotation,D=!1;if(0==L)D=o==M.Chain;else{D=!1;var X=this.target.bone;L*=X.a*X.d-X.b*X.c>0?m.degRad:-m.degRad}for(var Y=0,B=3;Y<u;Y++,B+=3){var U=d[Y];U.worldX+=(_-U.worldX)*n,U.worldY+=(O-U.worldY)*n;var W=N[B],q=N[B+1],H=W-_,j=q-O;if(h){var G=v[Y];if(0!=G){var z=(Math.sqrt(H*H+j*j)/G-1)*a+1;U.a*=z,U.c*=z}}if(_=W,O=q,r){var Z=U.a,Q=U.b,J=U.c,K=U.d,$=0,tt=0,et=0;if($=l?N[B-1]:0==f[Y+1]?N[B+2]:Math.atan2(j,H),$-=Math.atan2(J,Z),D){tt=Math.cos($),et=Math.sin($);var at=U.data.length;_+=(at*(tt*Z-et*J)-H)*a,O+=(at*(et*Z+tt*J)-j)*a}else $+=L;$>m.PI?$-=m.PI2:$<-m.PI&&($+=m.PI2),$*=a,tt=Math.cos($),et=Math.sin($),U.a=tt*Z-et*J,U.b=tt*Q-et*K,U.c=et*Z+tt*J,U.d=et*Q+tt*K}U.appliedValid=!1}}}}},{key:"computeWorldPositions",value:function(e,a,n,r,i){var s=this.target,o=this.position,l=this.spaces,h=p.setArraySize(this.positions,3*a+2),u=null,c=e.closed,d=e.worldVerticesLength,f=d/6,v=t.NONE;if(!e.constantSpeed){var g=e.lengths,m=g[f-=c?1:2];if(r&&(o*=m),i)for(var y=1;y<a;y++)l[y]*=m;u=p.setArraySize(this.world,8);for(var w=0,k=0,E=0;w<a;w++,k+=3){var x=l[w],b=o+=x;if(c)(b%=m)<0&&(b+=m),E=0;else{if(b<0){v!=t.BEFORE&&(v=t.BEFORE,e.computeWorldVertices(s,2,4,u,0,2)),this.addBeforePosition(b,u,0,h,k);continue}if(b>m){v!=t.AFTER&&(v=t.AFTER,e.computeWorldVertices(s,d-6,4,u,0,2)),this.addAfterPosition(b-m,u,0,h,k);continue}}for(;;E++){var M=g[E];if(!(b>M)){if(0==E)b/=M;else{var S=g[E-1];b=(b-S)/(M-S)}break}}E!=v&&(v=E,c&&E==f?(e.computeWorldVertices(s,d-4,4,u,0,2),e.computeWorldVertices(s,0,4,u,4,2)):e.computeWorldVertices(s,6*E+2,8,u,0,2)),this.addCurvePosition(b,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],h,k,n||w>0&&0==x)}return h}c?(d+=2,u=p.setArraySize(this.world,d),e.computeWorldVertices(s,2,d-4,u,0,2),e.computeWorldVertices(s,0,2,u,d-4,2),u[d-2]=u[0],u[d-1]=u[1]):(f--,d-=4,u=p.setArraySize(this.world,d),e.computeWorldVertices(s,2,d,u,0,2));for(var I=p.setArraySize(this.curves,f),A=0,T=u[0],R=u[1],C=0,V=0,P=0,F=0,N=0,_=0,O=0,L=0,D=0,X=0,Y=0,B=0,U=0,W=0,q=0,H=2;q<f;q++,H+=6)C=u[H],V=u[H+1],P=u[H+2],F=u[H+3],Y=2*(O=.1875*(T-2*C+P))+(D=.09375*(3*(C-P)-T+(N=u[H+4]))),B=2*(L=.1875*(R-2*V+F))+(X=.09375*(3*(V-F)-R+(_=u[H+5]))),U=.75*(C-T)+O+.16666667*D,W=.75*(V-R)+L+.16666667*X,A+=Math.sqrt(U*U+W*W),U+=Y,W+=B,Y+=D,B+=X,A+=Math.sqrt(U*U+W*W),U+=Y,W+=B,A+=Math.sqrt(U*U+W*W),U+=Y+D,W+=B+X,A+=Math.sqrt(U*U+W*W),I[q]=A,T=N,R=_;if(o*=r?A:A/e.lengths[f-1],i)for(var j=1;j<a;j++)l[j]*=A;for(var G=this.segments,z=0,Z=0,Q=0,J=0,K=0;Z<a;Z++,Q+=3){var $=l[Z],tt=o+=$;if(c)(tt%=A)<0&&(tt+=A),J=0;else{if(tt<0){this.addBeforePosition(tt,u,0,h,Q);continue}if(tt>A){this.addAfterPosition(tt-A,u,d-4,h,Q);continue}}for(;;J++){var et=I[J];if(!(tt>et)){if(0==J)tt/=et;else{var at=I[J-1];tt=(tt-at)/(et-at)}break}}if(J!=v){v=J;var nt=6*J;for(T=u[nt],R=u[nt+1],C=u[nt+2],V=u[nt+3],P=u[nt+4],F=u[nt+5],Y=2*(O=.03*(T-2*C+P))+(D=.006*(3*(C-P)-T+(N=u[nt+6]))),B=2*(L=.03*(R-2*V+F))+(X=.006*(3*(V-F)-R+(_=u[nt+7]))),U=.3*(C-T)+O+.16666667*D,W=.3*(V-R)+L+.16666667*X,z=Math.sqrt(U*U+W*W),G[0]=z,nt=1;nt<8;nt++)U+=Y,W+=B,Y+=D,B+=X,z+=Math.sqrt(U*U+W*W),G[nt]=z;U+=Y,W+=B,z+=Math.sqrt(U*U+W*W),G[8]=z,U+=Y+D,W+=B+X,z+=Math.sqrt(U*U+W*W),G[9]=z,K=0}for(tt*=z;;K++){var rt=G[K];if(!(tt>rt)){if(0==K)tt/=rt;else{var it=G[K-1];tt=K+(tt-it)/(rt-it)}break}}this.addCurvePosition(.1*tt,T,R,C,V,P,F,N,_,h,Q,n||Z>0&&0==$)}return h}},{key:"addBeforePosition",value:function(t,e,a,n,r){var i=e[a],s=e[a+1],o=e[a+2]-i,l=e[a+3]-s,h=Math.atan2(l,o);n[r]=i+t*Math.cos(h),n[r+1]=s+t*Math.sin(h),n[r+2]=h}},{key:"addAfterPosition",value:function(t,e,a,n,r){var i=e[a+2],s=e[a+3],o=i-e[a],l=s-e[a+1],h=Math.atan2(l,o);n[r]=i+t*Math.cos(h),n[r+1]=s+t*Math.sin(h),n[r+2]=h}},{key:"addCurvePosition",value:function(t,e,a,n,r,i,s,o,l,h,u,c){if(0==t||isNaN(t))return h[u]=e,h[u+1]=a,void(h[u+2]=Math.atan2(r-a,n-e));var d=t*t,f=d*t,v=1-t,g=v*v,m=g*v,p=v*t,y=3*p,w=v*y,k=y*t,E=e*m+n*w+i*k+o*f,x=a*m+r*w+s*k+l*f;h[u]=E,h[u+1]=x,c&&(h[u+2]=t<.001?Math.atan2(r-a,n-e):Math.atan2(x-(a*g+r*p*2+s*d),E-(e*g+n*p*2+i*d)))}}]),t}();N.NONE=-1,N.BEFORE=-2,N.AFTER=-3,N.epsilon=1e-5;var _=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).x=0,r.y=0,r.scaleX=1,r.scaleY=1,r.rotation=0,r.width=0,r.height=0,r.color=new g(1,1,1,1),r.path=void 0,r.rendererObject=void 0,r.region=void 0,r.offset=p.newFloatArray(8),r.uvs=p.newFloatArray(8),r.tempColor=new g(1,1,1,1),r}return i(a,[{key:"updateOffset",value:function(){var t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,r=-this.height/2*this.scaleY+this.region.offsetY*e,i=n+this.region.width*t,s=r+this.region.height*e,o=this.rotation*Math.PI/180,l=Math.cos(o),h=Math.sin(o),u=n*l+this.x,c=n*h,d=r*l+this.y,f=r*h,v=i*l+this.x,g=i*h,m=s*l+this.y,p=s*h,y=this.offset;y[a.OX1]=u-f,y[a.OY1]=d+c,y[a.OX2]=u-p,y[a.OY2]=m+c,y[a.OX3]=v-p,y[a.OY3]=m+g,y[a.OX4]=v-f,y[a.OY4]=d+g}},{key:"setRegion",value:function(t){this.region=t;var e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}},{key:"computeWorldVertices",value:function(t,e,n,r){var i=this.offset,s=t.worldX,o=t.worldY,l=t.a,h=t.b,u=t.c,c=t.d,d=0,f=0;d=i[a.OX1],f=i[a.OY1],e[n]=d*l+f*h+s,e[n+1]=d*u+f*c+o,n+=r,d=i[a.OX2],f=i[a.OY2],e[n]=d*l+f*h+s,e[n+1]=d*u+f*c+o,n+=r,d=i[a.OX3],f=i[a.OY3],e[n]=d*l+f*h+s,e[n+1]=d*u+f*c+o,n+=r,d=i[a.OX4],f=i[a.OY4],e[n]=d*l+f*h+s,e[n+1]=d*u+f*c+o}},{key:"copy",value:function(){var t=new a(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,p.arrayCopy(this.uvs,0,t.uvs,0,8),p.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t}}]),a}(V);_.OX1=0,_.OY1=1,_.OX2=2,_.OY2=3,_.OX3=4,_.OY3=5,_.OX4=6,_.OY4=7,_.X1=0,_.Y1=1,_.C1R=2,_.C1G=3,_.C1B=4,_.C1A=5,_.U1=6,_.V1=7,_.X2=8,_.Y2=9,_.C2R=10,_.C2G=11,_.C2B=12,_.C2A=13,_.U2=14,_.V2=15,_.X3=16,_.Y3=17,_.C3R=18,_.C3G=19,_.C3B=20,_.C3A=21,_.U3=22,_.V3=23,_.X4=24,_.Y4=25,_.C4R=26,_.C4G=27,_.C4B=28,_.C4A=29,_.U4=30,_.V4=31;var O,L,D=function(){function t(e){n(this,t),this._image=void 0,this._image=e}return i(t,[{key:"getImage",value:function(){return this._image}}],[{key:"filterFromString",value:function(t){switch(t.toLowerCase()){case"nearest":return O.Nearest;case"linear":return O.Linear;case"mipmap":return O.MipMap;case"mipmapnearestnearest":return O.MipMapNearestNearest;case"mipmaplinearnearest":return O.MipMapLinearNearest;case"mipmapnearestlinear":return O.MipMapNearestLinear;case"mipmaplinearlinear":return O.MipMapLinearLinear;default:throw new Error("Unknown texture filter ".concat(t))}}},{key:"wrapFromString",value:function(t){switch(t.toLowerCase()){case"mirroredtepeat":return L.MirroredRepeat;case"clamptoedge":return L.ClampToEdge;case"repeat":return L.Repeat;default:throw new Error("Unknown texture wrap ".concat(t))}}}]),t}();!function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"}(O||(O={})),function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"}(L||(L={}));var X,Y,B,U=function(t){o(a,t);var e=c(a);function a(){return n(this,a),e.apply(this,arguments)}return i(a,[{key:"setFilters",value:function(t,e){}},{key:"setWraps",value:function(t,e){}},{key:"dispose",value:function(){}}]),a}(D),W=function(){function t(e,a){n(this,t),this.pages=new Array,this.regions=new Array,this.load(e,a)}return i(t,[{key:"load",value:function(t,e){if(null==e)throw new Error("textureLoader cannot be null.");for(var a=new q(t),n=new Array(4),r=null;;){var i=a.readLine();if(null==i)break;if(0==(i=i.trim()).length)r=null;else if(r){var s=new j;s.name=i,s.page=r;var o=a.readValue();"true"==o.toLocaleLowerCase()?s.degrees=90:"false"==o.toLocaleLowerCase()?s.degrees=0:s.degrees=parseFloat(o),s.rotate=90==s.degrees,a.readTuple(n);var l=parseInt(n[0]),h=parseInt(n[1]);a.readTuple(n);var u=parseInt(n[0]),c=parseInt(n[1]);s.u=l/r.width,s.v=h/r.height,s.rotate?(s.u2=(l+c)/r.width,s.v2=(h+u)/r.height):(s.u2=(l+u)/r.width,s.v2=(h+c)/r.height),s.x=l,s.y=h,s.width=Math.abs(u),s.height=Math.abs(c),4==a.readTuple(n)&&4==a.readTuple(n)&&a.readTuple(n),s.originalWidth=parseInt(n[0]),s.originalHeight=parseInt(n[1]),a.readTuple(n),s.offsetX=parseInt(n[0]),s.offsetY=parseInt(n[1]),s.index=parseInt(a.readValue()),s.texture=r.texture,this.regions.push(s)}else{(r=new H).name=i,2==a.readTuple(n)&&(r.width=parseInt(n[0]),r.height=parseInt(n[1]),a.readTuple(n)),a.readTuple(n),r.minFilter=D.filterFromString(n[0]),r.magFilter=D.filterFromString(n[1]);var d=a.readValue();r.uWrap=L.ClampToEdge,r.vWrap=L.ClampToEdge,"x"==d?r.uWrap=L.Repeat:"y"==d?r.vWrap=L.Repeat:"xy"==d&&(r.uWrap=r.vWrap=L.Repeat),r.texture=e(i),r.texture.setFilters(r.minFilter,r.magFilter),r.texture.setWraps(r.uWrap,r.vWrap),r.width=r.texture.getImage().width,r.height=r.texture.getImage().height,this.pages.push(r)}}}},{key:"findRegion",value:function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}},{key:"dispose",value:function(){for(var t=0;t<this.pages.length;t++)this.pages[t].texture.dispose()}}]),t}(),q=function(){function t(e){n(this,t),this.lines=void 0,this.index=0,this.lines=e.split(/\r\n|\r|\n/)}return i(t,[{key:"readLine",value:function(){return this.index>=this.lines.length?null:this.lines[this.index++]}},{key:"readValue",value:function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw new Error("Invalid line: "+t);return t.substring(e+1).trim()}},{key:"readTuple",value:function(t){var e=this.readLine(),a=e.indexOf(":");if(-1==a)throw new Error("Invalid line: "+e);for(var n=0,r=a+1;n<3;n++){var i=e.indexOf(",",r);if(-1==i)break;t[n]=e.substr(r,i-r).trim(),r=i+1}return t[n]=e.substring(r).trim(),n+1}}]),t}(),H=function t(){n(this,t),this.name=void 0,this.minFilter=void 0,this.magFilter=void 0,this.uWrap=void 0,this.vWrap=void 0,this.texture=void 0,this.width=void 0,this.height=void 0},j=function(t){o(a,t);var e=c(a);function a(){var t;n(this,a);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(t=e.call.apply(e,[this].concat(i))).page=void 0,t.name=void 0,t.x=void 0,t.y=void 0,t.index=void 0,t.rotate=void 0,t.degrees=void 0,t.texture=void 0,t}return a}((function t(){n(this,t),this.renderObject=void 0,this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.rotate=!1,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0})),G=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).region=void 0,r.path=void 0,r.regionUVs=void 0,r.uvs=void 0,r.triangles=void 0,r.color=new g(1,1,1,1),r.width=void 0,r.height=void 0,r.hullLength=void 0,r.edges=void 0,r.parentMesh=void 0,r.tempColor=new g(0,0,0,0),r}return i(a,[{key:"updateUVs",value:function(){var t=this.regionUVs;null!=this.uvs&&this.uvs.length==t.length||(this.uvs=p.newFloatArray(t.length));var e=this.uvs,a=this.uvs.length,n=this.region.u,r=this.region.v,i=0,s=0;if(this.region instanceof j){var o=this.region,l=o.texture.getImage().width,h=o.texture.getImage().height;switch(o.degrees){case 90:n-=(o.originalHeight-o.offsetY-o.height)/l,r-=(o.originalWidth-o.offsetX-o.width)/h,i=o.originalHeight/l,s=o.originalWidth/h;for(var u=0;u<a;u+=2)e[u]=n+t[u+1]*i,e[u+1]=r+(1-t[u])*s;return;case 180:n-=(o.originalWidth-o.offsetX-o.width)/l,r-=o.offsetY/h,i=o.originalWidth/l,s=o.originalHeight/h;for(var c=0;c<a;c+=2)e[c]=n+(1-t[c])*i,e[c+1]=r+(1-t[c+1])*s;return;case 270:n-=o.offsetY/l,r-=o.offsetX/h,i=o.originalHeight/l,s=o.originalWidth/h;for(var d=0;d<a;d+=2)e[d]=n+(1-t[d+1])*i,e[d+1]=r+t[d]*s;return}n-=o.offsetX/l,r-=(o.originalHeight-o.offsetY-o.height)/h,i=o.originalWidth/l,s=o.originalHeight/h}else null==this.region?(n=r=0,i=s=1):(i=this.region.u2-n,s=this.region.v2-r);for(var f=0;f<a;f+=2)e[f]=n+t[f]*i,e[f+1]=r+t[f+1]*s}},{key:"getParentMesh",value:function(){return this.parentMesh}},{key:"setParentMesh",value:function(t){this.parentMesh=t,null!=t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}},{key:"copy",value:function(){if(null!=this.parentMesh)return this.newLinkedMesh();var t=new a(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),p.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=new Array(this.uvs.length),p.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),p.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,null!=this.edges&&(t.edges=new Array(this.edges.length),p.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}},{key:"newLinkedMesh",value:function(){var t=new a(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(null!=this.parentMesh?this.parentMesh:this),t.updateUVs(),t}}]),a}(P),z=function(){function t(e){if(n(this,t),this.data=void 0,this.bones=void 0,this.slots=void 0,this.drawOrder=void 0,this.ikConstraints=void 0,this.transformConstraints=void 0,this.pathConstraints=void 0,this._updateCache=new Array,this.updateCacheReset=new Array,this.skin=void 0,this.color=void 0,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==e)throw new Error("data cannot be null.");this.data=e,this.bones=new Array;for(var a=0;a<e.bones.length;a++){var r=e.bones[a],i=void 0;if(null==r.parent)i=new S(r,this,null);else{var s=this.bones[r.parent.index];i=new S(r,this,s),s.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(var o=0;o<e.slots.length;o++){var l=e.slots[o],h=this.bones[l.boneData.index],u=new I(l,h);this.slots.push(u),this.drawOrder.push(u)}this.ikConstraints=new Array;for(var c=0;c<e.ikConstraints.length;c++){var d=e.ikConstraints[c];this.ikConstraints.push(new A(d,this))}this.transformConstraints=new Array;for(var f=0;f<e.transformConstraints.length;f++){var v=e.transformConstraints[f];this.transformConstraints.push(new T(v,this))}this.pathConstraints=new Array;for(var m=0;m<e.pathConstraints.length;m++){var p=e.pathConstraints[m];this.pathConstraints.push(new N(p,this))}this.color=new g(1,1,1,1),this.updateCache()}return i(t,[{key:"updateCache",value:function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var t=this.bones,e=0,a=t.length;e<a;e++){var n=t[e];n.sorted=n.data.skinRequired,n.active=!n.sorted}if(null!=this.skin)for(var r=this.skin.bones,i=0,s=this.skin.bones.length;i<s;i++){var o=this.bones[r[i].index];do{o.sorted=!1,o.active=!0,o=o.parent}while(null!=o)}var l=this.ikConstraints,h=this.transformConstraints,u=this.pathConstraints,c=l.length,d=h.length,f=u.length,v=c+d+f;t:for(var g=0;g<v;g++){for(var m=0;m<c;m++){var p=l[m];if(p.data.order==g){this.sortIkConstraint(p);continue t}}for(var y=0;y<d;y++){var w=h[y];if(w.data.order==g){this.sortTransformConstraint(w);continue t}}for(var k=0;k<f;k++){var E=u[k];if(E.data.order==g){this.sortPathConstraint(E);continue t}}}for(var x=0,b=t.length;x<b;x++)this.sortBone(t[x])}},{key:"sortIkConstraint",value:function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&p.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target;this.sortBone(e);var a=t.bones,n=a[0];if(this.sortBone(n),a.length>1){var r=a[a.length-1];this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}this._updateCache.push(t),this.sortReset(n.children),a[a.length-1].sorted=!0}}},{key:"sortPathConstraint",value:function(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||null!=this.skin&&p.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target,a=e.data.index,n=e.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,a,n),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,a,n);for(var r=0,i=this.data.skins.length;r<i;r++)this.sortPathConstraintAttachment(this.data.skins[r],a,n);var s=e.getAttachment();s instanceof F&&this.sortPathConstraintAttachmentWith(s,n);for(var o=t.bones,l=o.length,h=0;h<l;h++)this.sortBone(o[h]);this._updateCache.push(t);for(var u=0;u<l;u++)this.sortReset(o[u].children);for(var c=0;c<l;c++)o[c].sorted=!0}}},{key:"sortTransformConstraint",value:function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&p.contains(this.skin.constraints,t.data,!0)),t.active){this.sortBone(t.target);var e=t.bones,a=e.length;if(t.data.local)for(var n=0;n<a;n++){var r=e[n];this.sortBone(r.parent),this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}else for(var i=0;i<a;i++)this.sortBone(e[i]);this._updateCache.push(t);for(var s=0;s<a;s++)this.sortReset(e[s].children);for(var o=0;o<a;o++)e[o].sorted=!0}}},{key:"sortPathConstraintAttachment",value:function(t,e,a){var n=t.attachments[e];if(n)for(var r in n)this.sortPathConstraintAttachmentWith(n[r],a)}},{key:"sortPathConstraintAttachmentWith",value:function(t,e){if(t instanceof F){var a=t.bones;if(null==a)this.sortBone(e);else for(var n=this.bones,r=0;r<a.length;)for(var i=a[r++],s=r+i;r<s;r++){var o=a[r];this.sortBone(n[o])}}}},{key:"sortBone",value:function(t){if(!t.sorted){var e=t.parent;null!=e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}}},{key:"sortReset",value:function(t){for(var e=0,a=t.length;e<a;e++){var n=t[e];n.active&&(n.sorted&&this.sortReset(n.children),n.sorted=!1)}}},{key:"updateWorldTransform",value:function(){for(var t=this.updateCacheReset,e=0,a=t.length;e<a;e++){var n=t[e];n.ax=n.x,n.ay=n.y,n.arotation=n.rotation,n.ascaleX=n.scaleX,n.ascaleY=n.scaleY,n.ashearX=n.shearX,n.ashearY=n.shearY,n.appliedValid=!0}for(var r=this._updateCache,i=0,s=r.length;i<s;i++)r[i].update()}},{key:"setToSetupPose",value:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}},{key:"setBonesToSetupPose",value:function(){for(var t=this.bones,e=0,a=t.length;e<a;e++)t[e].setToSetupPose();for(var n=this.ikConstraints,r=0,i=n.length;r<i;r++){var s=n[r];s.mix=s.data.mix,s.softness=s.data.softness,s.bendDirection=s.data.bendDirection,s.compress=s.data.compress,s.stretch=s.data.stretch}for(var o=this.transformConstraints,l=0,h=o.length;l<h;l++){var u=o[l],c=u.data;u.rotateMix=c.rotateMix,u.translateMix=c.translateMix,u.scaleMix=c.scaleMix,u.shearMix=c.shearMix}for(var d=this.pathConstraints,f=0,v=d.length;f<v;f++){var g=d[f],m=g.data;g.position=m.position,g.spacing=m.spacing,g.rotateMix=m.rotateMix,g.translateMix=m.translateMix}}},{key:"setSlotsToSetupPose",value:function(){var t=this.slots;p.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,a=t.length;e<a;e++)t[e].setToSetupPose()}},{key:"getRootBone",value:function(){return 0==this.bones.length?null:this.bones[0]}},{key:"findBone",value:function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,a=0,n=e.length;a<n;a++){var r=e[a];if(r.data.name==t)return r}return null}},{key:"findBoneIndex",value:function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,a=0,n=e.length;a<n;a++)if(e[a].data.name==t)return a;return-1}},{key:"findSlot",value:function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,a=0,n=e.length;a<n;a++){var r=e[a];if(r.data.name==t)return r}return null}},{key:"findSlotIndex",value:function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,a=0,n=e.length;a<n;a++)if(e[a].data.name==t)return a;return-1}},{key:"setSkinByName",value:function(t){var e=this.data.findSkin(t);if(null==e)throw new Error("Skin not found: "+t);this.setSkin(e)}},{key:"setSkin",value:function(t){if(t!=this.skin){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,a=0,n=e.length;a<n;a++){var r=e[a],i=r.data.attachmentName;if(null!=i){var s=t.getAttachment(a,i);null!=s&&r.setAttachment(s)}}this.skin=t,this.updateCache()}}},{key:"getAttachmentByName",value:function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}},{key:"getAttachment",value:function(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){var a=this.skin.getAttachment(t,e);if(null!=a)return a}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}},{key:"setAttachment",value:function(t,e){if(null==t)throw new Error("slotName cannot be null.");for(var a=this.slots,n=0,r=a.length;n<r;n++){var i=a[n];if(i.data.name==t){var s=null;if(null!=e&&null==(s=this.getAttachment(n,e)))throw new Error("Attachment not found: "+e+", for slot: "+t);return void i.setAttachment(s)}}throw new Error("Slot not found: "+t)}},{key:"findIkConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.data.name==t)return r}return null}},{key:"findTransformConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.data.name==t)return r}return null}},{key:"findPathConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.data.name==t)return r}return null}},{key:"getBounds",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Array(2);if(null==t)throw new Error("offset cannot be null.");if(null==e)throw new Error("size cannot be null.");for(var n=this.drawOrder,r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,l=0,h=n.length;l<h;l++){var u=n[l];if(u.bone.active){var c=0,d=null,f=u.getAttachment();if(f instanceof _)c=8,d=p.setArraySize(a,c,0),f.computeWorldVertices(u.bone,d,0,2);else if(f instanceof G){var v=f;c=v.worldVerticesLength,d=p.setArraySize(a,c,0),v.computeWorldVertices(u,0,c,d,0,2)}if(null!=d)for(var g=0,m=d.length;g<m;g+=2){var y=d[g],w=d[g+1];r=Math.min(r,y),i=Math.min(i,w),s=Math.max(s,y),o=Math.max(o,w)}}}t.set(r,i),e.set(s-r,o-i)}},{key:"update",value:function(t){this.time+=t}}]),t}(),Z=function(){function t(e,a,r){if(n(this,t),this.name=void 0,this.timelines=void 0,this.timelineIds=void 0,this.duration=void 0,null==e)throw new Error("name cannot be null.");if(null==a)throw new Error("timelines cannot be null.");this.name=e,this.timelines=a,this.timelineIds=[];for(var i=0;i<a.length;i++)this.timelineIds[a[i].getPropertyId()]=!0;this.duration=r}return i(t,[{key:"hasTimeline",value:function(t){return 1==this.timelineIds[t]}},{key:"apply",value:function(t,e,a,n,r,i,s,o){if(null==t)throw new Error("skeleton cannot be null.");n&&0!=this.duration&&(a%=this.duration,e>0&&(e%=this.duration));for(var l=this.timelines,h=0,u=l.length;h<u;h++)l[h].apply(t,e,a,r,i,s,o)}}],[{key:"binarySearch",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=0,r=t.length/a-2;if(0==r)return a;for(var i=r>>>1;;){if(t[(i+1)*a]<=e?n=i+1:r=i,n==r)return(n+1)*a;i=n+r>>>1}}},{key:"linearSearch",value:function(t,e,a){for(var n=0,r=t.length-a;n<=r;n+=a)if(t[n]>e)return n;return-1}}]),t}();!function(t){t[t.setup=0]="setup",t[t.first=1]="first",t[t.replace=2]="replace",t[t.add=3]="add"}(X||(X={})),function(t){t[t.mixIn=0]="mixIn",t[t.mixOut=1]="mixOut"}(Y||(Y={})),function(t){t[t.rotate=0]="rotate",t[t.translate=1]="translate",t[t.scale=2]="scale",t[t.shear=3]="shear",t[t.attachment=4]="attachment",t[t.color=5]="color",t[t.deform=6]="deform",t[t.event=7]="event",t[t.drawOrder=8]="drawOrder",t[t.ikConstraint=9]="ikConstraint",t[t.transformConstraint=10]="transformConstraint",t[t.pathConstraintPosition=11]="pathConstraintPosition",t[t.pathConstraintSpacing=12]="pathConstraintSpacing",t[t.pathConstraintMix=13]="pathConstraintMix",t[t.twoColor=14]="twoColor"}(B||(B={}));var Q=function(){function t(e){if(n(this,t),this.curves=void 0,e<=0)throw new Error("frameCount must be > 0: "+e);this.curves=p.newFloatArray((e-1)*t.BEZIER_SIZE)}return i(t,[{key:"getFrameCount",value:function(){return this.curves.length/t.BEZIER_SIZE+1}},{key:"setLinear",value:function(e){this.curves[e*t.BEZIER_SIZE]=t.LINEAR}},{key:"setStepped",value:function(e){this.curves[e*t.BEZIER_SIZE]=t.STEPPED}},{key:"getCurveType",value:function(e){var a=e*t.BEZIER_SIZE;if(a==this.curves.length)return t.LINEAR;var n=this.curves[a];return n==t.LINEAR?t.LINEAR:n==t.STEPPED?t.STEPPED:t.BEZIER}},{key:"setCurve",value:function(e,a,n,r,i){var s=.03*(2*-a+r),o=.03*(2*-n+i),l=.006*(3*(a-r)+1),h=.006*(3*(n-i)+1),u=2*s+l,c=2*o+h,d=.3*a+s+.16666667*l,f=.3*n+o+.16666667*h,v=e*t.BEZIER_SIZE,g=this.curves;g[v++]=t.BEZIER;for(var m=d,p=f,y=v+t.BEZIER_SIZE-1;v<y;v+=2)g[v]=m,g[v+1]=p,d+=u,f+=c,u+=l,c+=h,m+=d,p+=f}},{key:"getCurvePercent",value:function(e,a){a=m.clamp(a,0,1);var n=this.curves,r=e*t.BEZIER_SIZE,i=n[r];if(i==t.LINEAR)return a;if(i==t.STEPPED)return 0;for(var s=0,o=++r,l=r+t.BEZIER_SIZE-1;r<l;r+=2)if((s=n[r])>=a){var h=void 0,u=void 0;return r==o?(h=0,u=0):(h=n[r-2],u=n[r-1]),u+(n[r+1]-u)*(a-h)/(s-h)}var c=n[r-1];return c+(1-c)*(a-s)/(1-s)}}]),t}();Q.LINEAR=0,Q.STEPPED=1,Q.BEZIER=2,Q.BEZIER_SIZE=19;var J=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).boneIndex=void 0,r.frames=void 0,r.frames=p.newFloatArray(t<<1),r}return i(a,[{key:"getPropertyId",value:function(){return(B.rotate<<24)+this.boneIndex}},{key:"setFrame",value:function(t,e,n){t<<=1,this.frames[t]=e,this.frames[t+a.ROTATION]=n}},{key:"apply",value:function(t,e,n,r,i,s,o){var l=this.frames,h=t.bones[this.boneIndex];if(h.active)if(n<l[0])switch(s){case X.setup:return void(h.rotation=h.data.rotation);case X.first:var u=h.data.rotation-h.rotation;h.rotation+=(u-360*(16384-(16384.499999999996-u/360|0)))*i}else if(n>=l[l.length-a.ENTRIES]){var c=l[l.length+a.PREV_ROTATION];switch(s){case X.setup:h.rotation=h.data.rotation+c*i;break;case X.first:case X.replace:c+=h.data.rotation-h.rotation,c-=360*(16384-(16384.499999999996-c/360|0));case X.add:h.rotation+=c*i}}else{var d=Z.binarySearch(l,n,a.ENTRIES),f=l[d+a.PREV_ROTATION],v=l[d],g=this.getCurvePercent((d>>1)-1,1-(n-v)/(l[d+a.PREV_TIME]-v)),m=l[d+a.ROTATION]-f;switch(m=f+(m-360*(16384-(16384.499999999996-m/360|0)))*g,s){case X.setup:h.rotation=h.data.rotation+(m-360*(16384-(16384.499999999996-m/360|0)))*i;break;case X.first:case X.replace:m+=h.data.rotation-h.rotation;case X.add:h.rotation+=(m-360*(16384-(16384.499999999996-m/360|0)))*i}}}}]),a}(Q);J.ENTRIES=2,J.PREV_TIME=-2,J.PREV_ROTATION=-1,J.ROTATION=1;var K=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).boneIndex=void 0,r.frames=void 0,r.frames=p.newFloatArray(t*a.ENTRIES),r}return i(a,[{key:"getPropertyId",value:function(){return(B.translate<<24)+this.boneIndex}},{key:"setFrame",value:function(t,e,n,r){t*=a.ENTRIES,this.frames[t]=e,this.frames[t+a.X]=n,this.frames[t+a.Y]=r}},{key:"apply",value:function(t,e,n,r,i,s,o){var l=this.frames,h=t.bones[this.boneIndex];if(h.active)if(n<l[0])switch(s){case X.setup:return h.x=h.data.x,void(h.y=h.data.y);case X.first:h.x+=(h.data.x-h.x)*i,h.y+=(h.data.y-h.y)*i}else{var u=0,c=0;if(n>=l[l.length-a.ENTRIES])u=l[l.length+a.PREV_X],c=l[l.length+a.PREV_Y];else{var d=Z.binarySearch(l,n,a.ENTRIES);u=l[d+a.PREV_X],c=l[d+a.PREV_Y];var f=l[d],v=this.getCurvePercent(d/a.ENTRIES-1,1-(n-f)/(l[d+a.PREV_TIME]-f));u+=(l[d+a.X]-u)*v,c+=(l[d+a.Y]-c)*v}switch(s){case X.setup:h.x=h.data.x+u*i,h.y=h.data.y+c*i;break;case X.first:case X.replace:h.x+=(h.data.x+u-h.x)*i,h.y+=(h.data.y+c-h.y)*i;break;case X.add:h.x+=u*i,h.y+=c*i}}}}]),a}(Q);K.ENTRIES=3,K.PREV_TIME=-3,K.PREV_X=-2,K.PREV_Y=-1,K.X=1,K.Y=2;var $=function(t){o(a,t);var e=c(a);function a(t){return n(this,a),e.call(this,t)}return i(a,[{key:"getPropertyId",value:function(){return(B.scale<<24)+this.boneIndex}},{key:"apply",value:function(t,e,n,r,i,s,o){var l=this.frames,h=t.bones[this.boneIndex];if(h.active)if(n<l[0])switch(s){case X.setup:return h.scaleX=h.data.scaleX,void(h.scaleY=h.data.scaleY);case X.first:h.scaleX+=(h.data.scaleX-h.scaleX)*i,h.scaleY+=(h.data.scaleY-h.scaleY)*i}else{var u=0,c=0;if(n>=l[l.length-a.ENTRIES])u=l[l.length+a.PREV_X]*h.data.scaleX,c=l[l.length+a.PREV_Y]*h.data.scaleY;else{var d=Z.binarySearch(l,n,a.ENTRIES);u=l[d+a.PREV_X],c=l[d+a.PREV_Y];var f=l[d],v=this.getCurvePercent(d/a.ENTRIES-1,1-(n-f)/(l[d+a.PREV_TIME]-f));u=(u+(l[d+a.X]-u)*v)*h.data.scaleX,c=(c+(l[d+a.Y]-c)*v)*h.data.scaleY}if(1==i)s==X.add?(h.scaleX+=u-h.data.scaleX,h.scaleY+=c-h.data.scaleY):(h.scaleX=u,h.scaleY=c);else{var g=0,p=0;if(o==Y.mixOut)switch(s){case X.setup:g=h.data.scaleX,p=h.data.scaleY,h.scaleX=g+(Math.abs(u)*m.signum(g)-g)*i,h.scaleY=p+(Math.abs(c)*m.signum(p)-p)*i;break;case X.first:case X.replace:g=h.scaleX,p=h.scaleY,h.scaleX=g+(Math.abs(u)*m.signum(g)-g)*i,h.scaleY=p+(Math.abs(c)*m.signum(p)-p)*i;break;case X.add:g=h.scaleX,p=h.scaleY,h.scaleX=g+(Math.abs(u)*m.signum(g)-h.data.scaleX)*i,h.scaleY=p+(Math.abs(c)*m.signum(p)-h.data.scaleY)*i}else switch(s){case X.setup:g=Math.abs(h.data.scaleX)*m.signum(u),p=Math.abs(h.data.scaleY)*m.signum(c),h.scaleX=g+(u-g)*i,h.scaleY=p+(c-p)*i;break;case X.first:case X.replace:g=Math.abs(h.scaleX)*m.signum(u),p=Math.abs(h.scaleY)*m.signum(c),h.scaleX=g+(u-g)*i,h.scaleY=p+(c-p)*i;break;case X.add:g=m.signum(u),p=m.signum(c),h.scaleX=Math.abs(h.scaleX)*g+(u-Math.abs(h.data.scaleX)*g)*i,h.scaleY=Math.abs(h.scaleY)*p+(c-Math.abs(h.data.scaleY)*p)*i}}}}}]),a}(K),tt=function(t){o(a,t);var e=c(a);function a(t){return n(this,a),e.call(this,t)}return i(a,[{key:"getPropertyId",value:function(){return(B.shear<<24)+this.boneIndex}},{key:"apply",value:function(t,e,n,r,i,s,o){var l=this.frames,h=t.bones[this.boneIndex];if(h.active)if(n<l[0])switch(s){case X.setup:return h.shearX=h.data.shearX,void(h.shearY=h.data.shearY);case X.first:h.shearX+=(h.data.shearX-h.shearX)*i,h.shearY+=(h.data.shearY-h.shearY)*i}else{var u=0,c=0;if(n>=l[l.length-a.ENTRIES])u=l[l.length+a.PREV_X],c=l[l.length+a.PREV_Y];else{var d=Z.binarySearch(l,n,a.ENTRIES);u=l[d+a.PREV_X],c=l[d+a.PREV_Y];var f=l[d],v=this.getCurvePercent(d/a.ENTRIES-1,1-(n-f)/(l[d+a.PREV_TIME]-f));u+=(l[d+a.X]-u)*v,c+=(l[d+a.Y]-c)*v}switch(s){case X.setup:h.shearX=h.data.shearX+u*i,h.shearY=h.data.shearY+c*i;break;case X.first:case X.replace:h.shearX+=(h.data.shearX+u-h.shearX)*i,h.shearY+=(h.data.shearY+c-h.shearY)*i;break;case X.add:h.shearX+=u*i,h.shearY+=c*i}}}}]),a}(K),et=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).slotIndex=void 0,r.frames=void 0,r.frames=p.newFloatArray(t*a.ENTRIES),r}return i(a,[{key:"getPropertyId",value:function(){return(B.color<<24)+this.slotIndex}},{key:"setFrame",value:function(t,e,n,r,i,s){t*=a.ENTRIES,this.frames[t]=e,this.frames[t+a.R]=n,this.frames[t+a.G]=r,this.frames[t+a.B]=i,this.frames[t+a.A]=s}},{key:"apply",value:function(t,e,n,r,i,s,o){var l=t.slots[this.slotIndex];if(l.bone.active){var h=this.frames;if(n<h[0])switch(s){case X.setup:return void l.color.setFromColor(l.data.color);case X.first:var u=l.color,c=l.data.color;u.add((c.r-u.r)*i,(c.g-u.g)*i,(c.b-u.b)*i,(c.a-u.a)*i)}else{var d=0,f=0,v=0,g=0;if(n>=h[h.length-a.ENTRIES]){var m=h.length;d=h[m+a.PREV_R],f=h[m+a.PREV_G],v=h[m+a.PREV_B],g=h[m+a.PREV_A]}else{var p=Z.binarySearch(h,n,a.ENTRIES);d=h[p+a.PREV_R],f=h[p+a.PREV_G],v=h[p+a.PREV_B],g=h[p+a.PREV_A];var y=h[p],w=this.getCurvePercent(p/a.ENTRIES-1,1-(n-y)/(h[p+a.PREV_TIME]-y));d+=(h[p+a.R]-d)*w,f+=(h[p+a.G]-f)*w,v+=(h[p+a.B]-v)*w,g+=(h[p+a.A]-g)*w}if(1==i)l.color.set(d,f,v,g);else{var k=l.color;s==X.setup&&k.setFromColor(l.data.color),k.add((d-k.r)*i,(f-k.g)*i,(v-k.b)*i,(g-k.a)*i)}}}}}]),a}(Q);et.ENTRIES=5,et.PREV_TIME=-5,et.PREV_R=-4,et.PREV_G=-3,et.PREV_B=-2,et.PREV_A=-1,et.R=1,et.G=2,et.B=3,et.A=4;var at=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).slotIndex=void 0,r.frames=void 0,r.frames=p.newFloatArray(t*a.ENTRIES),r}return i(a,[{key:"getPropertyId",value:function(){return(B.twoColor<<24)+this.slotIndex}},{key:"setFrame",value:function(t,e,n,r,i,s,o,l,h){t*=a.ENTRIES,this.frames[t]=e,this.frames[t+a.R]=n,this.frames[t+a.G]=r,this.frames[t+a.B]=i,this.frames[t+a.A]=s,this.frames[t+a.R2]=o,this.frames[t+a.G2]=l,this.frames[t+a.B2]=h}},{key:"apply",value:function(t,e,n,r,i,s,o){var l=t.slots[this.slotIndex];if(l.bone.active){var h=this.frames;if(n<h[0])switch(s){case X.setup:return l.color.setFromColor(l.data.color),void l.darkColor.setFromColor(l.data.darkColor);case X.first:var u=l.color,c=l.darkColor,d=l.data.color,f=l.data.darkColor;u.add((d.r-u.r)*i,(d.g-u.g)*i,(d.b-u.b)*i,(d.a-u.a)*i),c.add((f.r-c.r)*i,(f.g-c.g)*i,(f.b-c.b)*i,0)}else{var v=0,g=0,m=0,p=0,y=0,w=0,k=0;if(n>=h[h.length-a.ENTRIES]){var E=h.length;v=h[E+a.PREV_R],g=h[E+a.PREV_G],m=h[E+a.PREV_B],p=h[E+a.PREV_A],y=h[E+a.PREV_R2],w=h[E+a.PREV_G2],k=h[E+a.PREV_B2]}else{var x=Z.binarySearch(h,n,a.ENTRIES);v=h[x+a.PREV_R],g=h[x+a.PREV_G],m=h[x+a.PREV_B],p=h[x+a.PREV_A],y=h[x+a.PREV_R2],w=h[x+a.PREV_G2],k=h[x+a.PREV_B2];var b=h[x],M=this.getCurvePercent(x/a.ENTRIES-1,1-(n-b)/(h[x+a.PREV_TIME]-b));v+=(h[x+a.R]-v)*M,g+=(h[x+a.G]-g)*M,m+=(h[x+a.B]-m)*M,p+=(h[x+a.A]-p)*M,y+=(h[x+a.R2]-y)*M,w+=(h[x+a.G2]-w)*M,k+=(h[x+a.B2]-k)*M}if(1==i)l.color.set(v,g,m,p),l.darkColor.set(y,w,k,1);else{var S=l.color,I=l.darkColor;s==X.setup&&(S.setFromColor(l.data.color),I.setFromColor(l.data.darkColor)),S.add((v-S.r)*i,(g-S.g)*i,(m-S.b)*i,(p-S.a)*i),I.add((y-I.r)*i,(w-I.g)*i,(k-I.b)*i,0)}}}}}]),a}(Q);at.ENTRIES=8,at.PREV_TIME=-8,at.PREV_R=-7,at.PREV_G=-6,at.PREV_B=-5,at.PREV_A=-4,at.PREV_R2=-3,at.PREV_G2=-2,at.PREV_B2=-1,at.R=1,at.G=2,at.B=3,at.A=4,at.R2=5,at.G2=6,at.B2=7;var nt=function(){function t(e){n(this,t),this.slotIndex=void 0,this.frames=void 0,this.attachmentNames=void 0,this.frames=p.newFloatArray(e),this.attachmentNames=new Array(e)}return i(t,[{key:"getPropertyId",value:function(){return(B.attachment<<24)+this.slotIndex}},{key:"getFrameCount",value:function(){return this.frames.length}},{key:"setFrame",value:function(t,e,a){this.frames[t]=e,this.attachmentNames[t]=a}},{key:"apply",value:function(t,e,a,n,r,i,s){var o=t.slots[this.slotIndex];if(o.bone.active)if(s!=Y.mixOut){var l=this.frames;if(a<l[0])i!=X.setup&&i!=X.first||this.setAttachment(t,o,o.data.attachmentName);else{var h;h=a>=l[l.length-1]?l.length-1:Z.binarySearch(l,a,1)-1;var u=this.attachmentNames[h];t.slots[this.slotIndex].setAttachment(null==u?null:t.getAttachment(this.slotIndex,u))}}else i==X.setup&&this.setAttachment(t,o,o.data.attachmentName)}},{key:"setAttachment",value:function(t,e,a){e.attachment=null==a?null:t.getAttachment(this.slotIndex,a)}}]),t}(),rt=null,it=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).slotIndex=void 0,r.attachment=void 0,r.frames=void 0,r.frameVertices=void 0,r.frames=p.newFloatArray(t),r.frameVertices=new Array(t),null==rt&&(rt=p.newFloatArray(64)),r}return i(a,[{key:"getPropertyId",value:function(){return(B.deform<<27)+ +this.attachment.id+this.slotIndex}},{key:"setFrame",value:function(t,e,a){this.frames[t]=e,this.frameVertices[t]=a}},{key:"apply",value:function(t,e,a,n,r,i,s){var o=t.slots[this.slotIndex];if(o.bone.active){var l=o.getAttachment();if(l instanceof P&&l.deformAttachment==this.attachment){var h=o.deform;0==h.length&&(i=X.setup);var u=this.frameVertices,c=u[0].length,d=this.frames;if(a<d[0]){var f=l;switch(i){case X.setup:return void(h.length=0);case X.first:if(1==r){h.length=0;break}var v=p.setArraySize(h,c);if(null==f.bones)for(var g=f.vertices,m=0;m<c;m++)v[m]+=(g[m]-v[m])*r;else for(r=1-r,m=0;m<c;m++)v[m]*=r}}else{var y=p.setArraySize(h,c);if(a>=d[d.length-1]){var w=u[d.length-1];if(1==r)if(i==X.add){var k=l;if(null==k.bones)for(var E=k.vertices,x=0;x<c;x++)y[x]+=w[x]-E[x];else for(var b=0;b<c;b++)y[b]+=w[b]}else p.arrayCopy(w,0,y,0,c);else switch(i){case X.setup:var M=l;if(null==M.bones)for(var S=M.vertices,I=0;I<c;I++){var A=S[I];y[I]=A+(w[I]-A)*r}else for(var T=0;T<c;T++)y[T]=w[T]*r;break;case X.first:case X.replace:for(var R=0;R<c;R++)y[R]+=(w[R]-y[R])*r;break;case X.add:var C=l;if(null==C.bones)for(var V=C.vertices,F=0;F<c;F++)y[F]+=(w[F]-V[F])*r;else for(var N=0;N<c;N++)y[N]+=w[N]*r}}else{var _=Z.binarySearch(d,a),O=u[_-1],L=u[_],D=d[_],Y=this.getCurvePercent(_-1,1-(a-D)/(d[_-1]-D));if(1==r)if(i==X.add){var B=l;if(null==B.bones)for(var U=B.vertices,W=0;W<c;W++){var q=O[W];y[W]+=q+(L[W]-q)*Y-U[W]}else for(var H=0;H<c;H++){var j=O[H];y[H]+=j+(L[H]-j)*Y}}else for(var G=0;G<c;G++){var z=O[G];y[G]=z+(L[G]-z)*Y}else switch(i){case X.setup:var Q=l;if(null==Q.bones)for(var J=Q.vertices,K=0;K<c;K++){var $=O[K],tt=J[K];y[K]=tt+($+(L[K]-$)*Y-tt)*r}else for(var et=0;et<c;et++){var at=O[et];y[et]=(at+(L[et]-at)*Y)*r}break;case X.first:case X.replace:for(var nt=0;nt<c;nt++){var rt=O[nt];y[nt]+=(rt+(L[nt]-rt)*Y-y[nt])*r}break;case X.add:var it=l;if(null==it.bones)for(var st=it.vertices,ot=0;ot<c;ot++){var lt=O[ot];y[ot]+=(lt+(L[ot]-lt)*Y-st[ot])*r}else for(var ht=0;ht<c;ht++){var ut=O[ht];y[ht]+=(ut+(L[ht]-ut)*Y)*r}}}}}}}}]),a}(Q),st=function(){function t(e){n(this,t),this.frames=void 0,this.events=void 0,this.frames=p.newFloatArray(e),this.events=new Array(e)}return i(t,[{key:"getPropertyId",value:function(){return B.event<<24}},{key:"getFrameCount",value:function(){return this.frames.length}},{key:"setFrame",value:function(t,e){this.frames[t]=e.time,this.events[t]=e}},{key:"apply",value:function(t,e,a,n,r,i,s){if(null!=n){var o=this.frames,l=this.frames.length;if(e>a)this.apply(t,e,Number.MAX_VALUE,n,r,i,s),e=-1;else if(e>=o[l-1])return;if(!(a<o[0])){var h=0;if(e<o[0])h=0;else for(var u=o[h=Z.binarySearch(o,e)];h>0&&o[h-1]==u;)h--;for(;h<l&&a>=o[h];h++)n.push(this.events[h])}}}}]),t}(),ot=function(){function t(e){n(this,t),this.frames=void 0,this.drawOrders=void 0,this.frames=p.newFloatArray(e),this.drawOrders=new Array(e)}return i(t,[{key:"getPropertyId",value:function(){return B.drawOrder<<24}},{key:"getFrameCount",value:function(){return this.frames.length}},{key:"setFrame",value:function(t,e,a){this.frames[t]=e,this.drawOrders[t]=a}},{key:"apply",value:function(t,e,a,n,r,i,s){var o=t.drawOrder,l=t.slots;if(s!=Y.mixOut){var h=this.frames;if(a<h[0])i!=X.setup&&i!=X.first||p.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);else{var u;u=a>=h[h.length-1]?h.length-1:Z.binarySearch(h,a)-1;var c=this.drawOrders[u];if(null==c)p.arrayCopy(l,0,o,0,l.length);else for(var d=0,f=c.length;d<f;d++)o[d]=l[c[d]]}}else i==X.setup&&p.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length)}}]),t}(),lt=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).ikConstraintIndex=void 0,r.frames=void 0,r.frames=p.newFloatArray(t*a.ENTRIES),r}return i(a,[{key:"getPropertyId",value:function(){return(B.ikConstraint<<24)+this.ikConstraintIndex}},{key:"setFrame",value:function(t,e,n,r,i,s,o){t*=a.ENTRIES,this.frames[t]=e,this.frames[t+a.MIX]=n,this.frames[t+a.SOFTNESS]=r,this.frames[t+a.BEND_DIRECTION]=i,this.frames[t+a.COMPRESS]=s?1:0,this.frames[t+a.STRETCH]=o?1:0}},{key:"apply",value:function(t,e,n,r,i,s,o){var l=this.frames,h=t.ikConstraints[this.ikConstraintIndex];if(h.active)if(n<l[0])switch(s){case X.setup:return h.mix=h.data.mix,h.softness=h.data.softness,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,void(h.stretch=h.data.stretch);case X.first:h.mix+=(h.data.mix-h.mix)*i,h.softness+=(h.data.softness-h.softness)*i,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch}else if(n>=l[l.length-a.ENTRIES])s==X.setup?(h.mix=h.data.mix+(l[l.length+a.PREV_MIX]-h.data.mix)*i,h.softness=h.data.softness+(l[l.length+a.PREV_SOFTNESS]-h.data.softness)*i,o==Y.mixOut?(h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch):(h.bendDirection=l[l.length+a.PREV_BEND_DIRECTION],h.compress=0!=l[l.length+a.PREV_COMPRESS],h.stretch=0!=l[l.length+a.PREV_STRETCH])):(h.mix+=(l[l.length+a.PREV_MIX]-h.mix)*i,h.softness+=(l[l.length+a.PREV_SOFTNESS]-h.softness)*i,o==Y.mixIn&&(h.bendDirection=l[l.length+a.PREV_BEND_DIRECTION],h.compress=0!=l[l.length+a.PREV_COMPRESS],h.stretch=0!=l[l.length+a.PREV_STRETCH]));else{var u=Z.binarySearch(l,n,a.ENTRIES),c=l[u+a.PREV_MIX],d=l[u+a.PREV_SOFTNESS],f=l[u],v=this.getCurvePercent(u/a.ENTRIES-1,1-(n-f)/(l[u+a.PREV_TIME]-f));s==X.setup?(h.mix=h.data.mix+(c+(l[u+a.MIX]-c)*v-h.data.mix)*i,h.softness=h.data.softness+(d+(l[u+a.SOFTNESS]-d)*v-h.data.softness)*i,o==Y.mixOut?(h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch):(h.bendDirection=l[u+a.PREV_BEND_DIRECTION],h.compress=0!=l[u+a.PREV_COMPRESS],h.stretch=0!=l[u+a.PREV_STRETCH])):(h.mix+=(c+(l[u+a.MIX]-c)*v-h.mix)*i,h.softness+=(d+(l[u+a.SOFTNESS]-d)*v-h.softness)*i,o==Y.mixIn&&(h.bendDirection=l[u+a.PREV_BEND_DIRECTION],h.compress=0!=l[u+a.PREV_COMPRESS],h.stretch=0!=l[u+a.PREV_STRETCH]))}}}]),a}(Q);lt.ENTRIES=6,lt.PREV_TIME=-6,lt.PREV_MIX=-5,lt.PREV_SOFTNESS=-4,lt.PREV_BEND_DIRECTION=-3,lt.PREV_COMPRESS=-2,lt.PREV_STRETCH=-1,lt.MIX=1,lt.SOFTNESS=2,lt.BEND_DIRECTION=3,lt.COMPRESS=4,lt.STRETCH=5;var ht=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).transformConstraintIndex=void 0,r.frames=void 0,r.frames=p.newFloatArray(t*a.ENTRIES),r}return i(a,[{key:"getPropertyId",value:function(){return(B.transformConstraint<<24)+this.transformConstraintIndex}},{key:"setFrame",value:function(t,e,n,r,i,s){t*=a.ENTRIES,this.frames[t]=e,this.frames[t+a.ROTATE]=n,this.frames[t+a.TRANSLATE]=r,this.frames[t+a.SCALE]=i,this.frames[t+a.SHEAR]=s}},{key:"apply",value:function(t,e,n,r,i,s,o){var l=this.frames,h=t.transformConstraints[this.transformConstraintIndex];if(h.active)if(n<l[0]){var u=h.data;switch(s){case X.setup:return h.rotateMix=u.rotateMix,h.translateMix=u.translateMix,h.scaleMix=u.scaleMix,void(h.shearMix=u.shearMix);case X.first:h.rotateMix+=(u.rotateMix-h.rotateMix)*i,h.translateMix+=(u.translateMix-h.translateMix)*i,h.scaleMix+=(u.scaleMix-h.scaleMix)*i,h.shearMix+=(u.shearMix-h.shearMix)*i}}else{var c=0,d=0,f=0,v=0;if(n>=l[l.length-a.ENTRIES]){var g=l.length;c=l[g+a.PREV_ROTATE],d=l[g+a.PREV_TRANSLATE],f=l[g+a.PREV_SCALE],v=l[g+a.PREV_SHEAR]}else{var m=Z.binarySearch(l,n,a.ENTRIES);c=l[m+a.PREV_ROTATE],d=l[m+a.PREV_TRANSLATE],f=l[m+a.PREV_SCALE],v=l[m+a.PREV_SHEAR];var p=l[m],y=this.getCurvePercent(m/a.ENTRIES-1,1-(n-p)/(l[m+a.PREV_TIME]-p));c+=(l[m+a.ROTATE]-c)*y,d+=(l[m+a.TRANSLATE]-d)*y,f+=(l[m+a.SCALE]-f)*y,v+=(l[m+a.SHEAR]-v)*y}if(s==X.setup){var w=h.data;h.rotateMix=w.rotateMix+(c-w.rotateMix)*i,h.translateMix=w.translateMix+(d-w.translateMix)*i,h.scaleMix=w.scaleMix+(f-w.scaleMix)*i,h.shearMix=w.shearMix+(v-w.shearMix)*i}else h.rotateMix+=(c-h.rotateMix)*i,h.translateMix+=(d-h.translateMix)*i,h.scaleMix+=(f-h.scaleMix)*i,h.shearMix+=(v-h.shearMix)*i}}}]),a}(Q);ht.ENTRIES=5,ht.PREV_TIME=-5,ht.PREV_ROTATE=-4,ht.PREV_TRANSLATE=-3,ht.PREV_SCALE=-2,ht.PREV_SHEAR=-1,ht.ROTATE=1,ht.TRANSLATE=2,ht.SCALE=3,ht.SHEAR=4;var ut=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).pathConstraintIndex=void 0,r.frames=void 0,r.frames=p.newFloatArray(t*a.ENTRIES),r}return i(a,[{key:"getPropertyId",value:function(){return(B.pathConstraintPosition<<24)+this.pathConstraintIndex}},{key:"setFrame",value:function(t,e,n){t*=a.ENTRIES,this.frames[t]=e,this.frames[t+a.VALUE]=n}},{key:"apply",value:function(t,e,n,r,i,s,o){var l=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(h.active)if(n<l[0])switch(s){case X.setup:return void(h.position=h.data.position);case X.first:h.position+=(h.data.position-h.position)*i}else{var u=0;if(n>=l[l.length-a.ENTRIES])u=l[l.length+a.PREV_VALUE];else{var c=Z.binarySearch(l,n,a.ENTRIES);u=l[c+a.PREV_VALUE];var d=l[c],f=this.getCurvePercent(c/a.ENTRIES-1,1-(n-d)/(l[c+a.PREV_TIME]-d));u+=(l[c+a.VALUE]-u)*f}s==X.setup?h.position=h.data.position+(u-h.data.position)*i:h.position+=(u-h.position)*i}}}]),a}(Q);ut.ENTRIES=2,ut.PREV_TIME=-2,ut.PREV_VALUE=-1,ut.VALUE=1;var ct=function(t){o(a,t);var e=c(a);function a(t){return n(this,a),e.call(this,t)}return i(a,[{key:"getPropertyId",value:function(){return(B.pathConstraintSpacing<<24)+this.pathConstraintIndex}},{key:"apply",value:function(t,e,n,r,i,s,o){var l=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(h.active)if(n<l[0])switch(s){case X.setup:return void(h.spacing=h.data.spacing);case X.first:h.spacing+=(h.data.spacing-h.spacing)*i}else{var u=0;if(n>=l[l.length-a.ENTRIES])u=l[l.length+a.PREV_VALUE];else{var c=Z.binarySearch(l,n,a.ENTRIES);u=l[c+a.PREV_VALUE];var d=l[c],f=this.getCurvePercent(c/a.ENTRIES-1,1-(n-d)/(l[c+a.PREV_TIME]-d));u+=(l[c+a.VALUE]-u)*f}s==X.setup?h.spacing=h.data.spacing+(u-h.data.spacing)*i:h.spacing+=(u-h.spacing)*i}}}]),a}(ut),dt=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).pathConstraintIndex=void 0,r.frames=void 0,r.frames=p.newFloatArray(t*a.ENTRIES),r}return i(a,[{key:"getPropertyId",value:function(){return(B.pathConstraintMix<<24)+this.pathConstraintIndex}},{key:"setFrame",value:function(t,e,n,r){t*=a.ENTRIES,this.frames[t]=e,this.frames[t+a.ROTATE]=n,this.frames[t+a.TRANSLATE]=r}},{key:"apply",value:function(t,e,n,r,i,s,o){var l=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(h.active)if(n<l[0])switch(s){case X.setup:return h.rotateMix=h.data.rotateMix,void(h.translateMix=h.data.translateMix);case X.first:h.rotateMix+=(h.data.rotateMix-h.rotateMix)*i,h.translateMix+=(h.data.translateMix-h.translateMix)*i}else{var u=0,c=0;if(n>=l[l.length-a.ENTRIES])u=l[l.length+a.PREV_ROTATE],c=l[l.length+a.PREV_TRANSLATE];else{var d=Z.binarySearch(l,n,a.ENTRIES);u=l[d+a.PREV_ROTATE],c=l[d+a.PREV_TRANSLATE];var f=l[d],v=this.getCurvePercent(d/a.ENTRIES-1,1-(n-f)/(l[d+a.PREV_TIME]-f));u+=(l[d+a.ROTATE]-u)*v,c+=(l[d+a.TRANSLATE]-c)*v}s==X.setup?(h.rotateMix=h.data.rotateMix+(u-h.data.rotateMix)*i,h.translateMix=h.data.translateMix+(c-h.data.translateMix)*i):(h.rotateMix+=(u-h.rotateMix)*i,h.translateMix+=(c-h.translateMix)*i)}}}]),a}(Q);dt.ENTRIES=3,dt.PREV_TIME=-3,dt.PREV_ROTATE=-2,dt.PREV_TRANSLATE=-1,dt.ROTATE=1,dt.TRANSLATE=2;var ft=function(){function t(e){n(this,t),this.data=void 0,this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new mt(this),this.propertyIDs=new v,this.animationsChanged=!1,this.trackEntryPool=new w((function(){return new gt})),this.data=e}return i(t,[{key:"update",value:function(t){t*=this.timeScale;for(var e=this.tracks,a=0,n=e.length;a<n;a++){var r=e[a];if(null!=r){r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;var i=t*r.timeScale;if(r.delay>0){if(r.delay-=i,r.delay>0)continue;i=-r.delay,r.delay=0}var s=r.next;if(null!=s){var o=r.trackLast-s.delay;if(o>=0){for(s.delay=0,s.trackTime+=0==r.timeScale?0:(o/r.timeScale+t)*s.timeScale,r.trackTime+=i,this.setCurrent(a,s,!0);null!=s.mixingFrom;)s.mixTime+=t,s=s.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&null==r.mixingFrom){e[a]=null,this.queue.end(r),this.disposeNext(r);continue}if(null!=r.mixingFrom&&this.updateMixingFrom(r,t)){var l=r.mixingFrom;for(r.mixingFrom=null,null!=l&&(l.mixingTo=null);null!=l;)this.queue.end(l),l=l.mixingFrom}r.trackTime+=i}}this.queue.drain()}},{key:"updateMixingFrom",value:function(t,e){var a=t.mixingFrom;if(null==a)return!0;var n=this.updateMixingFrom(a,e);return a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=a.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=a.mixingFrom,null!=a.mixingFrom&&(a.mixingFrom.mixingTo=t),t.interruptAlpha=a.interruptAlpha,this.queue.end(a)),n):(a.trackTime+=e*a.timeScale,t.mixTime+=e,!1)}},{key:"apply",value:function(e){if(null==e)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var a=this.events,n=this.tracks,r=!1,i=0,s=n.length;i<s;i++){var o=n[i];if(!(null==o||o.delay>0)){r=!0;var l=0==i?X.first:o.mixBlend,h=o.alpha;null!=o.mixingFrom?h*=this.applyMixingFrom(o,e,l):o.trackTime>=o.trackEnd&&null==o.next&&(h=0);var u=o.animationLast,c=o.getAnimationTime(),d=o.animation.timelines.length,f=o.animation.timelines;if(0==i&&1==h||l==X.add)for(var v=0;v<d;v++){p.webkit602BugfixHelper(h,l);var g=f[v];g instanceof nt?this.applyAttachmentTimeline(g,e,c,l,!0):g.apply(e,u,c,a,h,l,Y.mixIn)}else{var m=o.timelineMode,y=0==o.timelinesRotation.length;y&&p.setArraySize(o.timelinesRotation,d<<1,null);for(var w=o.timelinesRotation,k=0;k<d;k++){var E=f[k],x=m[k]==t.SUBSEQUENT?l:X.setup;E instanceof J?this.applyRotateTimeline(E,e,c,h,x,w,k<<1,y):E instanceof nt?this.applyAttachmentTimeline(E,e,c,l,!0):(p.webkit602BugfixHelper(h,l),E.apply(e,u,c,a,h,x,Y.mixIn))}}this.queueEvents(o,c),a.length=0,o.nextAnimationLast=c,o.nextTrackLast=o.trackTime}}for(var b=this.unkeyedState+t.SETUP,M=e.slots,S=0,I=e.slots.length;S<I;S++){var A=M[S];if(A.attachmentState==b){var T=A.data.attachmentName;A.attachment=null==T?null:e.getAttachment(A.data.index,T)}}return this.unkeyedState+=2,this.queue.drain(),r}},{key:"applyMixingFrom",value:function(e,a,n){var r=e.mixingFrom;null!=r.mixingFrom&&this.applyMixingFrom(r,a,n);var i=0;0==e.mixDuration?(i=1,n==X.first&&(n=X.setup)):((i=e.mixTime/e.mixDuration)>1&&(i=1),n!=X.first&&(n=r.mixBlend));var s=i<r.eventThreshold?this.events:null,o=i<r.attachmentThreshold,l=i<r.drawOrderThreshold,h=r.animationLast,u=r.getAnimationTime(),c=r.animation.timelines.length,d=r.animation.timelines,f=r.alpha*e.interruptAlpha,v=f*(1-i);if(n==X.add)for(var g=0;g<c;g++)d[g].apply(a,h,u,s,v,n,Y.mixOut);else{var m=r.timelineMode,y=r.timelineHoldMix,w=0==r.timelinesRotation.length;w&&p.setArraySize(r.timelinesRotation,c<<1,null);var k=r.timelinesRotation;r.totalAlpha=0;for(var E=0;E<c;E++){var x=d[E],b=Y.mixOut,M=void 0,S=0;switch(m[E]){case t.SUBSEQUENT:if(!l&&x instanceof ot)continue;M=n,S=v;break;case t.FIRST:M=X.setup,S=v;break;case t.HOLD_SUBSEQUENT:M=n,S=f;break;case t.HOLD_FIRST:M=X.setup,S=f;break;default:M=X.setup;var I=y[E];S=f*Math.max(0,1-I.mixTime/I.mixDuration)}r.totalAlpha+=S,x instanceof J?this.applyRotateTimeline(x,a,u,S,M,k,E<<1,w):x instanceof nt?this.applyAttachmentTimeline(x,a,u,M,o):(p.webkit602BugfixHelper(S,n),l&&x instanceof ot&&M==X.setup&&(b=Y.mixIn),x.apply(a,h,u,s,S,M,b))}}return e.mixDuration>0&&this.queueEvents(r,u),this.events.length=0,r.nextAnimationLast=u,r.nextTrackLast=r.trackTime,i}},{key:"applyAttachmentTimeline",value:function(e,a,n,r,i){var s=a.slots[e.slotIndex];if(s.bone.active){var o,l=e.frames;n<l[0]?r!=X.setup&&r!=X.first||this.setAttachment(a,s,s.data.attachmentName,i):(o=n>=l[l.length-1]?l.length-1:Z.binarySearch(l,n)-1,this.setAttachment(a,s,e.attachmentNames[o],i)),s.attachmentState<=this.unkeyedState&&(s.attachmentState=this.unkeyedState+t.SETUP)}}},{key:"setAttachment",value:function(e,a,n,r){a.attachment=null==n?null:e.getAttachment(a.data.index,n),r&&(a.attachmentState=this.unkeyedState+t.CURRENT)}},{key:"applyRotateTimeline",value:function(t,e,a,n,r,i,s,o){if(o&&(i[s]=0),1!=n){var l=t,h=l.frames,u=e.bones[l.boneIndex];if(u.active){var c=0,d=0;if(a<h[0])switch(r){case X.setup:u.rotation=u.data.rotation;default:return;case X.first:c=u.rotation,d=u.data.rotation}else if(c=r==X.setup?u.data.rotation:u.rotation,a>=h[h.length-J.ENTRIES])d=u.data.rotation+h[h.length+J.PREV_ROTATION];else{var f=Z.binarySearch(h,a,J.ENTRIES),v=h[f+J.PREV_ROTATION],g=h[f],p=l.getCurvePercent((f>>1)-1,1-(a-g)/(h[f+J.PREV_TIME]-g));d=h[f+J.ROTATION]-v,d=v+(d-=360*(16384-(16384.499999999996-d/360|0)))*p+u.data.rotation,d-=360*(16384-(16384.499999999996-d/360|0))}var y=0,w=d-c;if(0==(w-=360*(16384-(16384.499999999996-w/360|0))))y=i[s];else{var k=0,E=0;o?(k=0,E=w):(k=i[s],E=i[s+1]);var x=w>0,b=k>=0;m.signum(E)!=m.signum(w)&&Math.abs(E)<=90&&(Math.abs(k)>180&&(k+=360*m.signum(k)),b=x),y=w+k-k%360,b!=x&&(y+=360*m.signum(k)),i[s]=y}i[s+1]=w,c+=y*n,u.rotation=c-360*(16384-(16384.499999999996-c/360|0))}}else t.apply(e,0,a,null,1,r,Y.mixIn)}},{key:"queueEvents",value:function(t,e){for(var a=t.animationStart,n=t.animationEnd,r=n-a,i=t.trackLast%r,s=this.events,o=0,l=s.length;o<l;o++){var h=s[o];if(h.time<i)break;h.time>n||this.queue.event(t,h)}for((t.loop?0==r||i>t.trackTime%r:e>=n&&t.animationLast<n)&&this.queue.complete(t);o<l;o++)s[o].time<a||this.queue.event(t,s[o])}},{key:"clearTracks",value:function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,a=this.tracks.length;e<a;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}},{key:"clearTrack",value:function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(null!=e){this.queue.end(e),this.disposeNext(e);for(var a=e;;){var n=a.mixingFrom;if(null==n)break;this.queue.end(n),a.mixingFrom=null,a.mixingTo=null,a=n}this.tracks[e.trackIndex]=null,this.queue.drain()}}}},{key:"setCurrent",value:function(t,e,a){var n=this.expandToIndex(t);this.tracks[t]=e,null!=n&&(a&&this.queue.interrupt(n),e.mixingFrom=n,n.mixingTo=e,e.mixTime=0,null!=n.mixingFrom&&n.mixDuration>0&&(e.interruptAlpha*=Math.min(1,n.mixTime/n.mixDuration)),n.timelinesRotation.length=0),this.queue.start(e)}},{key:"setAnimation",value:function(t,e,a){var n=this.data.skeletonData.findAnimation(e);if(null==n)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,n,a)}},{key:"setAnimationWith",value:function(t,e,a){if(null==e)throw new Error("animation cannot be null.");var n=!0,r=this.expandToIndex(t);null!=r&&(-1==r.nextTrackLast?(this.tracks[t]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.disposeNext(r),r=r.mixingFrom,n=!1):this.disposeNext(r));var i=this.trackEntry(t,e,a,r);return this.setCurrent(t,i,n),this.queue.drain(),i}},{key:"addAnimation",value:function(t,e,a,n){var r=this.data.skeletonData.findAnimation(e);if(null==r)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,r,a,n)}},{key:"addAnimationWith",value:function(t,e,a,n){if(null==e)throw new Error("animation cannot be null.");var r=this.expandToIndex(t);if(null!=r)for(;null!=r.next;)r=r.next;var i=this.trackEntry(t,e,a,r);if(null==r)this.setCurrent(t,i,!0),this.queue.drain();else if(r.next=i,n<=0){var s=r.animationEnd-r.animationStart;0!=s?(r.loop?n+=s*(1+(r.trackTime/s|0)):n+=Math.max(s,r.trackTime),n-=this.data.getMix(r.animation,e)):n=r.trackTime}return i.delay=n,i}},{key:"setEmptyAnimation",value:function(e,a){var n=this.setAnimationWith(e,t.emptyAnimation,!1);return n.mixDuration=a,n.trackEnd=a,n}},{key:"addEmptyAnimation",value:function(e,a,n){n<=0&&(n-=a);var r=this.addAnimationWith(e,t.emptyAnimation,!1,n);return r.mixDuration=a,r.trackEnd=a,r}},{key:"setEmptyAnimations",value:function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var a=0,n=this.tracks.length;a<n;a++){var r=this.tracks[a];null!=r&&this.setEmptyAnimation(r.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}},{key:"expandToIndex",value:function(t){return t<this.tracks.length?this.tracks[t]:(p.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}},{key:"trackEntry",value:function(t,e,a,n){var r=this.trackEntryPool.obtain();return r.trackIndex=t,r.animation=e,r.loop=a,r.holdPrevious=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=e.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.interruptAlpha=1,r.mixTime=0,r.mixDuration=null==n?0:this.data.getMix(n.animation,e),r.mixBlend=X.replace,r}},{key:"disposeNext",value:function(t){for(var e=t.next;null!=e;)this.queue.dispose(e),e=e.next;t.next=null}},{key:"_animationsChanged",value:function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var t=0,e=this.tracks.length;t<e;t++){var a=this.tracks[t];if(null!=a){for(;null!=a.mixingFrom;)a=a.mixingFrom;do{null!=a.mixingFrom&&a.mixBlend==X.add||this.computeHold(a),a=a.mixingTo}while(null!=a)}}}},{key:"computeHold",value:function(e){var a=e.mixingTo,n=e.animation.timelines,r=e.animation.timelines.length,i=p.setArraySize(e.timelineMode,r);e.timelineHoldMix.length=0;var s=p.setArraySize(e.timelineHoldMix,r),o=this.propertyIDs;if(null!=a&&a.holdPrevious)for(var l=0;l<r;l++)i[l]=o.add(n[l].getPropertyId())?t.HOLD_FIRST:t.HOLD_SUBSEQUENT;else t:for(var h=0;h<r;h++){var u=n[h],c=u.getPropertyId();if(o.add(c))if(null==a||u instanceof nt||u instanceof ot||u instanceof st||!a.animation.hasTimeline(c))i[h]=t.FIRST;else{for(var d=a.mixingTo;null!=d;d=d.mixingTo)if(!d.animation.hasTimeline(c)){if(e.mixDuration>0){i[h]=t.HOLD_MIX,s[h]=d;continue t}break}i[h]=t.HOLD_FIRST}else i[h]=t.SUBSEQUENT}}},{key:"getCurrent",value:function(t){return t>=this.tracks.length?null:this.tracks[t]}},{key:"addListener",value:function(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)}},{key:"removeListener",value:function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}},{key:"clearListeners",value:function(){this.listeners.length=0}},{key:"clearListenerNotifications",value:function(){this.queue.clear()}}]),t}();ft.emptyAnimation=new Z("<empty>",[],0),ft.SUBSEQUENT=0,ft.FIRST=1,ft.HOLD_SUBSEQUENT=2,ft.HOLD_FIRST=3,ft.HOLD_MIX=4,ft.SETUP=1,ft.CURRENT=2;var vt,gt=function(){function t(){n(this,t),this.animation=void 0,this.next=void 0,this.mixingFrom=void 0,this.mixingTo=void 0,this.listener=void 0,this.trackIndex=void 0,this.loop=void 0,this.holdPrevious=void 0,this.eventThreshold=void 0,this.attachmentThreshold=void 0,this.drawOrderThreshold=void 0,this.animationStart=void 0,this.animationEnd=void 0,this.animationLast=void 0,this.nextAnimationLast=void 0,this.delay=void 0,this.trackTime=void 0,this.trackLast=void 0,this.nextTrackLast=void 0,this.trackEnd=void 0,this.timeScale=void 0,this.alpha=void 0,this.mixTime=void 0,this.mixDuration=void 0,this.interruptAlpha=void 0,this.totalAlpha=void 0,this.mixBlend=X.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}return i(t,[{key:"reset",value:function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}},{key:"getAnimationTime",value:function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}},{key:"setAnimationLast",value:function(t){this.animationLast=t,this.nextAnimationLast=t}},{key:"isComplete",value:function(){return this.trackTime>=this.animationEnd-this.animationStart}},{key:"resetRotationDirections",value:function(){this.timelinesRotation.length=0}}]),t}(),mt=function(){function t(e){n(this,t),this.objects=[],this.drainDisabled=!1,this.animState=void 0,this.animState=e}return i(t,[{key:"start",value:function(t){this.objects.push(vt.start),this.objects.push(t),this.animState.animationsChanged=!0}},{key:"interrupt",value:function(t){this.objects.push(vt.interrupt),this.objects.push(t)}},{key:"end",value:function(t){this.objects.push(vt.end),this.objects.push(t),this.animState.animationsChanged=!0}},{key:"dispose",value:function(t){this.objects.push(vt.dispose),this.objects.push(t)}},{key:"complete",value:function(t){this.objects.push(vt.complete),this.objects.push(t)}},{key:"event",value:function(t){function e(e,a){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){this.objects.push(vt.event),this.objects.push(t),this.objects.push(e)}))},{key:"drain",value:function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,a=0;a<t.length;a+=2){var n=t[a],r=t[a+1];switch(n){case vt.start:null!=r.listener&&r.listener.start&&r.listener.start(r);for(var i=0;i<e.length;i++)e[i].start&&e[i].start(r);break;case vt.interrupt:null!=r.listener&&r.listener.interrupt&&r.listener.interrupt(r);for(var s=0;s<e.length;s++)e[s].interrupt&&e[s].interrupt(r);break;case vt.end:null!=r.listener&&r.listener.end&&r.listener.end(r);for(var o=0;o<e.length;o++)e[o].end&&e[o].end(r);case vt.dispose:null!=r.listener&&r.listener.dispose&&r.listener.dispose(r);for(var l=0;l<e.length;l++)e[l].dispose&&e[l].dispose(r);this.animState.trackEntryPool.free(r);break;case vt.complete:null!=r.listener&&r.listener.complete&&r.listener.complete(r);for(var h=0;h<e.length;h++)e[h].complete&&e[h].complete(r);break;case vt.event:var u=t[2+a++];null!=r.listener&&r.listener.event&&r.listener.event(r,u);for(var c=0;c<e.length;c++)e[c].event&&e[c].event(r,u)}}this.clear(),this.drainDisabled=!1}}},{key:"clear",value:function(){this.objects.length=0}}]),t}();!function(t){t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event"}(vt||(vt={}));var pt,yt,wt,kt,Et,xt,bt=function(){function t(e){if(n(this,t),this.skeletonData=void 0,this.animationToMixTime={},this.defaultMix=0,null==e)throw new Error("skeletonData cannot be null.");this.skeletonData=e}return i(t,[{key:"setMix",value:function(t,e,a){var n=this.skeletonData.findAnimation(t);if(null==n)throw new Error("Animation not found: "+t);var r=this.skeletonData.findAnimation(e);if(null==r)throw new Error("Animation not found: "+e);this.setMixWith(n,r,a)}},{key:"setMixWith",value:function(t,e,a){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");var n=t.name+"."+e.name;this.animationToMixTime[n]=a}},{key:"getMix",value:function(t,e){var a=t.name+"."+e.name,n=this.animationToMixTime[a];return void 0===n?this.defaultMix:n}}]),t}(),Mt=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).endSlot=void 0,r.color=new g(.2275,.2275,.8078,1),r}return i(a,[{key:"copy",value:function(){var t=new a(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}]),a}(P),St=function(){function t(){n(this,t),this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new w((function(){return new Array})),this.polygonIndicesPool=new w((function(){return new Array}))}return i(t,[{key:"triangulate",value:function(e){var a=e,n=e.length>>1,r=this.indicesArray;r.length=0;for(var i=0;i<n;i++)r[i]=i;var s=this.isConcaveArray;s.length=0;for(var o=0,l=n;o<l;++o)s[o]=t.isConcave(o,n,a,r);var h=this.triangles;for(h.length=0;n>3;){for(var u=n-1,c=0,d=1;;){t:if(!s[c]){for(var f=r[u]<<1,v=r[c]<<1,g=r[d]<<1,m=a[f],p=a[f+1],y=a[v],w=a[v+1],k=a[g],E=a[g+1],x=(d+1)%n;x!=u;x=(x+1)%n)if(s[x]){var b=r[x]<<1,M=a[b],S=a[b+1];if(t.positiveArea(k,E,m,p,M,S)&&t.positiveArea(m,p,y,w,M,S)&&t.positiveArea(y,w,k,E,M,S))break t}break}if(0==d){do{if(!s[c])break;c--}while(c>0);break}u=c,c=d,d=(d+1)%n}h.push(r[(n+c-1)%n]),h.push(r[c]),h.push(r[(c+1)%n]),r.splice(c,1),s.splice(c,1);var I=(--n+c-1)%n,A=c==n?0:c;s[I]=t.isConcave(I,n,a,r),s[A]=t.isConcave(A,n,a,r)}return 3==n&&(h.push(r[2]),h.push(r[0]),h.push(r[1])),h}},{key:"decompose",value:function(e,a){var n=e,r=this.convexPolygons;this.polygonPool.freeAll(r),r.length=0;var i=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(i),i.length=0;var s=this.polygonIndicesPool.obtain();s.length=0;var o=this.polygonPool.obtain();o.length=0;for(var l=-1,h=0,u=0,c=a.length;u<c;u+=3){var d=a[u]<<1,f=a[u+1]<<1,v=a[u+2]<<1,g=n[d],m=n[d+1],p=n[f],y=n[f+1],w=n[v],k=n[v+1],E=!1;if(l==d){var x=o.length-4,b=t.winding(o[x],o[x+1],o[x+2],o[x+3],w,k),M=t.winding(w,k,o[0],o[1],o[2],o[3]);b==h&&M==h&&(o.push(w),o.push(k),s.push(v),E=!0)}E||(o.length>0?(r.push(o),i.push(s)):(this.polygonPool.free(o),this.polygonIndicesPool.free(s)),(o=this.polygonPool.obtain()).length=0,o.push(g),o.push(m),o.push(p),o.push(y),o.push(w),o.push(k),(s=this.polygonIndicesPool.obtain()).length=0,s.push(d),s.push(f),s.push(v),h=t.winding(g,m,p,y,w,k),l=d)}o.length>0&&(r.push(o),i.push(s));for(var S=0,I=r.length;S<I;S++)if(0!=(s=i[S]).length)for(var A=s[0],T=s[s.length-1],R=(o=r[S]).length-4,C=o[R],V=o[R+1],P=o[R+2],F=o[R+3],N=o[0],_=o[1],O=o[2],L=o[3],D=t.winding(C,V,P,F,N,_),X=0;X<I;X++)if(X!=S){var Y=i[X];if(3==Y.length){var B=Y[0],U=Y[1],W=Y[2],q=r[X],H=q[q.length-2],j=q[q.length-1];if(B==A&&U==T){var G=t.winding(C,V,P,F,H,j),z=t.winding(H,j,N,_,O,L);G==D&&z==D&&(q.length=0,Y.length=0,o.push(H),o.push(j),s.push(W),C=P,V=F,P=H,F=j,X=0)}}}for(var Z=r.length-1;Z>=0;Z--)0==(o=r[Z]).length&&(r.splice(Z,1),this.polygonPool.free(o),s=i[Z],i.splice(Z,1),this.polygonIndicesPool.free(s));return r}}],[{key:"isConcave",value:function(t,e,a,n){var r=n[(e+t-1)%e]<<1,i=n[t]<<1,s=n[(t+1)%e]<<1;return!this.positiveArea(a[r],a[r+1],a[i],a[i+1],a[s],a[s+1])}},{key:"positiveArea",value:function(t,e,a,n,r,i){return t*(i-n)+a*(e-i)+r*(n-e)>=0}},{key:"winding",value:function(t,e,a,n,r,i){var s=a-t,o=n-e;return r*o-i*s+s*e-t*o>=0?1:-1}}]),t}(),It=function(){function t(){n(this,t),this.triangulator=new St,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array,this.clipAttachment=void 0,this.clippingPolygons=void 0}return i(t,[{key:"clipStart",value:function(e,a){if(null!=this.clipAttachment)return 0;this.clipAttachment=a;var n=a.worldVerticesLength,r=p.setArraySize(this.clippingPolygon,n);a.computeWorldVertices(e,0,n,r,0,2);var i=this.clippingPolygon;t.makeClockwise(i);for(var s=this.clippingPolygons=this.triangulator.decompose(i,this.triangulator.triangulate(i)),o=0,l=s.length;o<l;o++){var h=s[o];t.makeClockwise(h),h.push(h[0]),h.push(h[1])}return s.length}},{key:"clipEndWithSlot",value:function(t){null!=this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()}},{key:"clipEnd",value:function(){null!=this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}},{key:"isClipping",value:function(){return null!=this.clipAttachment}},{key:"clipTriangles",value:function(t,e,a,n,r,i,s,o){var l=this.clipOutput,h=this.clippedVertices,u=this.clippedTriangles,c=this.clippingPolygons,d=this.clippingPolygons.length,f=o?12:8,v=0;h.length=0,u.length=0;t:for(var g=0;g<n;g+=3)for(var m=a[g]<<1,y=t[m],w=t[m+1],k=r[m],E=r[m+1],x=t[m=a[g+1]<<1],b=t[m+1],M=r[m],S=r[m+1],I=t[m=a[g+2]<<1],A=t[m+1],T=r[m],R=r[m+1],C=0;C<d;C++){var V=h.length;if(!this.clip(y,w,x,b,I,A,c[C],l)){var P=p.setArraySize(h,V+3*f);P[V]=y,P[V+1]=w,P[V+2]=i.r,P[V+3]=i.g,P[V+4]=i.b,P[V+5]=i.a,o?(P[V+6]=k,P[V+7]=E,P[V+8]=s.r,P[V+9]=s.g,P[V+10]=s.b,P[V+11]=s.a,P[V+12]=x,P[V+13]=b,P[V+14]=i.r,P[V+15]=i.g,P[V+16]=i.b,P[V+17]=i.a,P[V+18]=M,P[V+19]=S,P[V+20]=s.r,P[V+21]=s.g,P[V+22]=s.b,P[V+23]=s.a,P[V+24]=I,P[V+25]=A,P[V+26]=i.r,P[V+27]=i.g,P[V+28]=i.b,P[V+29]=i.a,P[V+30]=T,P[V+31]=R,P[V+32]=s.r,P[V+33]=s.g,P[V+34]=s.b,P[V+35]=s.a):(P[V+6]=k,P[V+7]=E,P[V+8]=x,P[V+9]=b,P[V+10]=i.r,P[V+11]=i.g,P[V+12]=i.b,P[V+13]=i.a,P[V+14]=M,P[V+15]=S,P[V+16]=I,P[V+17]=A,P[V+18]=i.r,P[V+19]=i.g,P[V+20]=i.b,P[V+21]=i.a,P[V+22]=T,P[V+23]=R),V=u.length;var F=p.setArraySize(u,V+3);F[V]=v,F[V+1]=v+1,F[V+2]=v+2,v+=3;continue t}var N=l.length;if(0!=N){for(var _=b-A,O=I-x,L=y-I,D=A-w,X=1/(_*L+O*(w-A)),Y=N>>1,B=this.clipOutput,U=p.setArraySize(h,V+Y*f),W=0;W<N;W+=2){var q=B[W],H=B[W+1];U[V]=q,U[V+1]=H,U[V+2]=i.r,U[V+3]=i.g,U[V+4]=i.b,U[V+5]=i.a;var j=q-I,G=H-A,z=(_*j+O*G)*X,Z=(D*j+L*G)*X,Q=1-z-Z;U[V+6]=k*z+M*Z+T*Q,U[V+7]=E*z+S*Z+R*Q,o&&(U[V+8]=s.r,U[V+9]=s.g,U[V+10]=s.b,U[V+11]=s.a),V+=f}V=u.length;var J=p.setArraySize(u,V+3*(Y-2));Y--;for(var K=1;K<Y;K++)J[V]=v,J[V+1]=v+K,J[V+2]=v+K+1,V+=3;v+=Y+1}}}},{key:"clip",value:function(t,e,a,n,r,i,s,o){var l=o,h=!1,u=null;s.length%4>=2?(u=o,o=this.scratch):u=this.scratch,u.length=0,u.push(t),u.push(e),u.push(a),u.push(n),u.push(r),u.push(i),u.push(t),u.push(e),o.length=0;for(var c=s,d=s.length-4,f=0;;f+=2){for(var v=c[f],g=c[f+1],m=c[f+2],p=c[f+3],y=v-m,w=g-p,k=u,E=u.length-2,x=o.length,b=0;b<E;b+=2){var M=k[b],S=k[b+1],I=k[b+2],A=k[b+3],T=y*(A-p)-w*(I-m)>0;if(y*(S-p)-w*(M-m)>0){if(T){o.push(I),o.push(A);continue}var R=A-S,C=I-M,V=R*(m-v)-C*(p-g);if(Math.abs(V)>1e-6){var P=(C*(g-S)-R*(v-M))/V;o.push(v+(m-v)*P),o.push(g+(p-g)*P)}else o.push(v),o.push(g)}else if(T){var F=A-S,N=I-M,_=F*(m-v)-N*(p-g);if(Math.abs(_)>1e-6){var O=(N*(g-S)-F*(v-M))/_;o.push(v+(m-v)*O),o.push(g+(p-g)*O)}else o.push(v),o.push(g);o.push(I),o.push(A)}h=!0}if(x==o.length)return l.length=0,!0;if(o.push(o[0]),o.push(o[1]),f==d)break;var L=o;(o=u).length=0,u=L}if(l!=o){l.length=0;for(var D=0,X=o.length-2;D<X;D++)l[D]=o[D]}else l.length=l.length-2;return h}}],[{key:"makeClockwise",value:function(t){for(var e=t,a=t.length,n=e[a-2]*e[1]-e[0]*e[a-1],r=0,i=0,s=0,o=0,l=a-3;o<l;o+=2)r=e[o],i=e[o+1],s=e[o+2],n+=r*e[o+3]-s*i;if(!(n<0))for(var h=0,u=a-2,c=a>>1;h<c;h+=2){var d=e[h],f=e[h+1],v=u-h;e[h]=e[v],e[h+1]=e[v+1],e[v]=d,e[v+1]=f}}}]),t}(),At=function(){function t(){n(this,t),this._mesh=void 0,this.indexBuffer=void 0,this.vertexBuffer=void 0}return i(t,[{key:"mesh",get:function(){return this._mesh}},{key:"initialize",value:function(t,a){var n=this._mesh=new e.BufferMesh(t),r=new Uint16Array(a),i=[new e.VertexElement("POSITION",0,e.VertexElementFormat.Vector3,0),new e.VertexElement("COLOR",12,e.VertexElementFormat.Vector4,0),new e.VertexElement("TEXCOORD",28,e.VertexElementFormat.Vector2,0)],s=36*a,o=new e.Buffer(t,e.BufferBindFlag.VertexBuffer,s,e.BufferUsage.Dynamic),l=new e.Buffer(t,e.BufferBindFlag.IndexBuffer,r,e.BufferUsage.Dynamic);this.indexBuffer=l,this.vertexBuffer=o,n.setVertexBufferBinding(o,36),n.setIndexBufferBinding(l,e.IndexFormat.UInt16),n.setVertexElements(i),n.addSubMesh(0,r.length)}},{key:"fillVertexData",value:function(t){this.vertexBuffer.setData(t,0,0,0,e.SetDataOptions.Discard)}},{key:"fillIndexData",value:function(t){this.indexBuffer.setData(t,0,0,0,e.SetDataOptions.Discard)}}]),t}(),Tt=function(){function t(e,a){n(this,t),this.setting=void 0,this.engine=void 0,this.entity=void 0,this.clipper=new It,this.spineMesh=new At,this.vertexCount=0,this.indicesLength=0,this.verticesLength=0,this.vertices=new Float32Array(1024),this.verticesWithZ=new Float32Array(1024),this.indices=new Uint16Array(1024),this.tempColor=new g,this.engine=e,this.entity=a}return i(t,[{key:"mesh",get:function(){return this.spineMesh.mesh}},{key:"buildMesh",value:function(a,n){if(a){n&&(this.setting=n);var r=this.entity.getComponent(e.MeshRenderer);if(r){if(0===this.vertexCount){var i=this.getVertexCount(a);this.spineMesh.initialize(this.engine,i),r.mesh=this.spineMesh.mesh}var s=this.setting||{},o=s.useClipping,l=void 0===o||o,h=s.zSpacing,u=void 0===h?.01:h;this.verticesLength=0,this.indicesLength=0;for(var c=a.drawOrder,d=this.clipper,f=this.vertices,v=null,g=null,m=0;m<c.length;m+=1){var p=c[m];if(p.bone.active){var y=p.getAttachment(),w=null,k=null,E=u*m,x=0,b=d.isClipping()?2:t.VERTEX_SIZE;if(y instanceof _){var M=y;w=M.color,f=this.vertices,x=4*b,M.computeWorldVertices(p.bone,f,0,b),v=t.QUAD_TRIANGLES,g=M.uvs,k=M.region.renderObject.texture}else if(y instanceof G){var S=y;w=S.color,f=this.vertices,x=(S.worldVerticesLength>>1)*b,f.length,S.computeWorldVertices(p,0,S.worldVerticesLength,f,0,b),v=S.triangles,g=S.uvs,k=S.region.renderObject.texture}else{if(!(y instanceof Mt))continue;if(l){var I=y;d.clipStart(p,I);continue}}if(null!=k){var A=p.bone.skeleton.color,T=p.color,R=A.a*T.a*w.a,C=this.tempColor;C.set(A.r*T.r*w.r,A.g*T.g*w.g,A.b*T.b*w.b,R);var V=void 0,P=void 0,F=void 0;if(d.isClipping()){d.clipTriangles(f,x,v,v.length,g,C,null,!1);var N=d.clippedVertices,O=d.clippedTriangles;V=N.length,P=O,F=O.length}else{for(var L=f,D=2,X=0,Y=x;D<Y;D+=b,X+=2)L[D]=C.r,L[D+1]=C.g,L[D+2]=C.b,L[D+3]=C.a,L[D+4]=g[X],L[D+5]=g[X+1];V=x,P=v,F=v.length}if(0==V||0==F)continue;for(var B=this.verticesLength/t.VERTEX_STRIDE,U=this.verticesWithZ,W=this.verticesLength,q=0;q<V;)U[W++]=f[q++],U[W++]=f[q++],U[W++]=E,U[W++]=f[q++],U[W++]=f[q++],U[W++]=f[q++],U[W++]=f[q++],U[W++]=f[q++],U[W++]=f[q++];this.verticesLength=W;var H=this.indices;for(W=this.indicesLength,q=0;q<F;W++,q++)H[W]=P[q]+B;this.indicesLength+=F}var j=r.getMaterial(0);j.shaderData.getTexture("map")||j.shaderData.setTexture("map",k.texture),d.clipEndWithSlot(p)}else d.clipEndWithSlot(p)}d.clipEnd()}else console.warn("You need add MeshRenderer component to entity first")}}},{key:"fillVertexData",value:function(){this.spineMesh.fillVertexData(this.verticesWithZ)}},{key:"fillIndexData",value:function(){this.spineMesh.fillIndexData(this.indices)}},{key:"addSubMesh",value:function(t){}},{key:"getVertexCount",value:function(e){if(e){for(var a=e.drawOrder,n=0,r=0,i=a.length;r<i;r++){var s=a[r];if(s.bone.active){var o=s.getAttachment();if(o)if(o instanceof _)n+=t.QUAD_TRIANGLES.length;else{if(!(o instanceof G))continue;n+=o.triangles.length}}}return this.vertices=new Float32Array(n*t.VERTEX_SIZE/3),this.verticesWithZ=new Float32Array(n*t.VERTEX_STRIDE/3),this.indices=new Uint16Array(n),this.vertexCount=n,n}}}]),t}();Tt.QUAD_TRIANGLES=[0,1,2,2,3,0],Tt.VERTEX_SIZE=8,Tt.VERTEX_STRIDE=9;var Rt,Ct=(pt=function(t){o(r,t);var e=c(r);function r(t){var a;return n(this,r),d(a=e.call(this,t),"_skeletonData",yt,h(a)),d(a,"_skeleton",wt,h(a)),d(a,"_state",kt,h(a)),d(a,"_meshGenerator",Et,h(a)),d(a,"setting",xt,h(a)),a.autoUpdate=!0,a._meshGenerator=new Tt(a.engine,t),a}return i(r,[{key:"skeletonData",get:function(){return this._skeletonData}},{key:"skeleton",get:function(){return this._skeleton}},{key:"state",get:function(){return this._state}},{key:"mesh",get:function(){return this._meshGenerator.mesh}},{key:"scale",set:function(t){this._skeleton&&(this._skeleton.scaleX=t,this._skeleton.scaleY=t)}},{key:"setSkeletonData",value:function(t,e){this._skeletonData=t,this.setting=e,this._skeleton=new z(t);var a=new bt(t);this._state=new ft(a),this._meshGenerator.buildMesh(this._skeleton,this.setting)}},{key:"disposeCurrentSkeleton",value:function(){this._skeletonData=null}},{key:"onUpdate",value:function(t){this.autoUpdate&&this.updateState(.001*t)}},{key:"updateState",value:function(t){if(this._skeleton&&this.state){var e=this._state,a=this._skeleton;e.update(t),e.apply(a),a.updateWorldTransform(),this.updateGeometry()}}},{key:"updateGeometry",value:function(){this._meshGenerator.buildMesh(this._skeleton,this.setting),this._meshGenerator.fillVertexData(),this._meshGenerator.fillIndexData()}},{key:"_cloneTo",value:function(t){t.setSkeletonData(this.skeletonData);var e=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},this.setting);t.setting=e}}]),r}(e.Script),yt=f(pt.prototype,"_skeletonData",[e.ignoreClone],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt=f(pt.prototype,"_skeleton",[e.ignoreClone],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kt=f(pt.prototype,"_state",[e.ignoreClone],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Et=f(pt.prototype,"_meshGenerator",[e.ignoreClone],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt=f(pt.prototype,"setting",[e.ignoreClone],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pt),Vt=function(){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n(this,t),this.pathPrefix=void 0,this.textureLoader=void 0,this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.rawDataUris={},this.textureLoader=e,this.pathPrefix=a}return i(t,[{key:"downloadText",value:function(t,e,a){var n=new XMLHttpRequest;n.overrideMimeType("text/html"),this.rawDataUris[t]&&(t=this.rawDataUris[t]),n.open("GET",t,!0),n.onload=function(){200==n.status?e(n.responseText):a(n.status,n.responseText)},n.onerror=function(){a(n.status,n.responseText)},n.send()}},{key:"downloadBinary",value:function(t,e,a){var n=new XMLHttpRequest;this.rawDataUris[t]&&(t=this.rawDataUris[t]),n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status?e(new Uint8Array(n.response)):a(n.status,n.responseText)},n.onerror=function(){a(n.status,n.responseText)},n.send()}},{key:"setRawDataURI",value:function(t,e){this.rawDataUris[this.pathPrefix+t]=e}},{key:"loadBinary",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t=this.pathPrefix+t,this.toLoad++,this.downloadBinary(t,(function(n){e.assets[t]=n,a&&a(t,n),e.toLoad--,e.loaded++}),(function(a,r){e.errors[t]="Couldn't load binary ".concat(t,": status ").concat(status,", ").concat(r),n&&n(t,"Couldn't load binary ".concat(t,": status ").concat(status,", ").concat(r)),e.toLoad--,e.loaded++}))}},{key:"loadText",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(function(n){e.assets[t]=n,a&&a(t,n),e.toLoad--,e.loaded++}),(function(a,r){e.errors[t]="Couldn't load text ".concat(t,": status ").concat(status,", ").concat(r),n&&n(t,"Couldn't load text ".concat(t,": status ").concat(status,", ").concat(r)),e.toLoad--,e.loaded++}))}},{key:"loadTexture",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t=this.pathPrefix+t;this.toLoad++;var i=new Image;i.crossOrigin="anonymous",i.onload=function(n){var s=e.textureLoader(i);e.assets[r]=s,e.toLoad--,e.loaded++,a&&a(t,i)},i.onerror=function(a){e.errors[t]="Couldn't load image ".concat(t),e.toLoad--,e.loaded++,n&&n(t,"Couldn't load image ".concat(t))},this.rawDataUris[t]&&(t=this.rawDataUris[t]),i.src=t}},{key:"loadTextureAtlas",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.lastIndexOf("/")>=0?t.substring(0,t.lastIndexOf("/")):"";t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(function(i){var s={count:0},o=new Array;try{new W(i,(function(t){o.push(""==r?t:r+"/"+t);var e=document.createElement("img");return e.width=16,e.height=16,new U(e)}))}catch(a){var l=a;return e.errors[t]="Couldn't load texture atlas ".concat(t,": ").concat(l.message),n&&n(t,"Couldn't load texture atlas ".concat(t,": ").concat(l.message)),e.toLoad--,void e.loaded++}for(var h=function(){var l=c[u],h=!1;e.loadTexture(l,(function(l,u){if(s.count++,s.count==o.length)if(h)e.errors[t]="Couldn't load texture atlas page ".concat(l,"} of atlas ").concat(t),n&&n(t,"Couldn't load texture atlas page ".concat(l," of atlas ").concat(t)),e.toLoad--,e.loaded++;else try{var c=new W(i,(function(t){return e.get(""==r?t:r+"/"+t)}));e.assets[t]=c,a&&a(t,c),e.toLoad--,e.loaded++}catch(a){var d=a;e.errors[t]="Couldn't load texture atlas ".concat(t,": ").concat(d.message),n&&n(t,"Couldn't load texture atlas ".concat(t,": ").concat(d.message)),e.toLoad--,e.loaded++}}),(function(a,r){h=!0,s.count++,s.count==o.length&&(e.errors[t]="Couldn't load texture atlas page ".concat(a,"} of atlas ").concat(t),n&&n(t,"Couldn't load texture atlas page ".concat(a," of atlas ").concat(t)),e.toLoad--,e.loaded++)}))},u=0,c=o;u<c.length;u++)h()}),(function(a,r){e.errors[t]="Couldn't load texture atlas ".concat(t,": status ").concat(status,", ").concat(r),n&&n(t,"Couldn't load texture atlas ".concat(t,": status ").concat(status,", ").concat(r)),e.toLoad--,e.loaded++}))}},{key:"get",value:function(t){return t=this.pathPrefix+t,this.assets[t]}},{key:"remove",value:function(t){t=this.pathPrefix+t;var e=this.assets[t];e.dispose&&e.dispose(),this.assets[t]=null}},{key:"removeAll",value:function(){for(var t in this.assets){var e=this.assets[t];e.dispose&&e.dispose()}this.assets={}}},{key:"isLoadingComplete",value:function(){return 0==this.toLoad}},{key:"getToLoad",value:function(){return this.toLoad}},{key:"getLoaded",value:function(){return this.loaded}},{key:"dispose",value:function(){this.removeAll()}},{key:"hasErrors",value:function(){return Object.keys(this.errors).length>0}},{key:"getErrors",value:function(){return this.errors}}]),t}(),Pt=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).color=new g(1,1,1,1),r}return i(a,[{key:"copy",value:function(){var t=new a(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}]),a}(P),Ft=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t)).x=void 0,r.y=void 0,r.rotation=void 0,r.color=new g(.38,.94,0,1),r.name=t,r}return i(a,[{key:"computeWorldPosition",value:function(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e}},{key:"computeWorldRotation",value:function(t){var e=m.cosDeg(this.rotation),a=m.sinDeg(this.rotation),n=e*t.a+a*t.b,r=e*t.c+a*t.d;return Math.atan2(r,n)*m.radDeg}},{key:"copy",value:function(){var t=new a(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}]),a}(P),Nt=function(){function t(e){n(this,t),this.atlas=void 0,this.atlas=e}return i(t,[{key:"newRegionAttachment",value:function(t,e,a){var n=this.atlas.findRegion(a);if(null==n)throw new Error("Region not found in atlas: "+a+" (region attachment: "+e+")");n.renderObject=n;var r=new _(e);return r.setRegion(n),r}},{key:"newMeshAttachment",value:function(t,e,a){var n=this.atlas.findRegion(a);if(null==n)throw new Error("Region not found in atlas: "+a+" (mesh attachment: "+e+")");n.renderObject=n;var r=new G(e);return r.region=n,r}},{key:"newBoundingBoxAttachment",value:function(t,e){return new Pt(e)}},{key:"newPathAttachment",value:function(t,e){return new F(e)}},{key:"newPointAttachment",value:function(t,e){return new Ft(e)}},{key:"newClippingAttachment",value:function(t,e){return new Mt(e)}}]),t}(),_t=function(){function t(){n(this,t),this.name=void 0,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=void 0,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.version=void 0,this.hash=void 0,this.fps=0,this.imagesPath=void 0,this.audioPath=void 0}return i(t,[{key:"findBone",value:function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findBoneIndex",value:function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,a=0,n=e.length;a<n;a++)if(e[a].name==t)return a;return-1}},{key:"findSlot",value:function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findSlotIndex",value:function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,a=0,n=e.length;a<n;a++)if(e[a].name==t)return a;return-1}},{key:"findSkin",value:function(t){if(null==t)throw new Error("skinName cannot be null.");for(var e=this.skins,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findEvent",value:function(t){if(null==t)throw new Error("eventDataName cannot be null.");for(var e=this.events,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findAnimation",value:function(t){if(null==t)throw new Error("animationName cannot be null.");for(var e=this.animations,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findIkConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findTransformConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findPathConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findPathConstraintIndex",value:function(t){if(null==t)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,a=0,n=e.length;a<n;a++)if(e[a].name==t)return a;return-1}}]),t}(),Ot=function t(e,a,r){if(n(this,t),this.index=void 0,this.name=void 0,this.boneData=void 0,this.color=new g(1,1,1,1),this.darkColor=void 0,this.attachmentName=void 0,this.blendMode=void 0,e<0)throw new Error("index must be >= 0.");if(null==a)throw new Error("name cannot be null.");if(null==r)throw new Error("boneData cannot be null.");this.index=e,this.name=a,this.boneData=r},Lt=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t,0,!1)).bones=new Array,r.target=void 0,r.bendDirection=1,r.compress=!1,r.stretch=!1,r.uniform=!1,r.mix=1,r.softness=0,r}return a}(R),Dt=function(t){o(a,t);var e=c(a);function a(t){var r;return n(this,a),(r=e.call(this,t,0,!1)).bones=new Array,r.target=void 0,r.rotateMix=0,r.translateMix=0,r.scaleMix=0,r.shearMix=0,r.offsetRotation=0,r.offsetX=0,r.offsetY=0,r.offsetScaleX=0,r.offsetScaleY=0,r.offsetShearY=0,r.relative=!1,r.local=!1,r}return a}(R),Xt=function t(e,a,r){n(this,t),this.slotIndex=e,this.name=a,this.attachment=r},Yt=function(){function t(e){if(n(this,t),this.name=void 0,this.attachments=new Array,this.bones=Array(),this.constraints=new Array,null==e)throw new Error("name cannot be null.");this.name=e}return i(t,[{key:"setAttachment",value:function(t,e,a){if(null==a)throw new Error("attachment cannot be null.");var n=this.attachments;t>=n.length&&(n.length=t+1),n[t]||(n[t]={}),n[t][e]=a}},{key:"addSkin",value:function(t){for(var e=0;e<t.bones.length;e++){for(var a=t.bones[e],n=!1,r=0;r<this.bones.length;r++)if(this.bones[r]==a){n=!0;break}n||this.bones.push(a)}for(var i=0;i<t.constraints.length;i++){for(var s=t.constraints[i],o=!1,l=0;l<this.constraints.length;l++)if(this.constraints[l]==s){o=!0;break}o||this.constraints.push(s)}for(var h=t.getAttachments(),u=0;u<h.length;u++){var c=h[u];this.setAttachment(c.slotIndex,c.name,c.attachment)}}},{key:"copySkin",value:function(t){for(var e=0;e<t.bones.length;e++){for(var a=t.bones[e],n=!1,r=0;r<this.bones.length;r++)if(this.bones[r]==a){n=!0;break}n||this.bones.push(a)}for(var i=0;i<t.constraints.length;i++){for(var s=t.constraints[i],o=!1,l=0;l<this.constraints.length;l++)if(this.constraints[l]==s){o=!0;break}o||this.constraints.push(s)}for(var h=t.getAttachments(),u=0;u<h.length;u++){var c=h[u];null!=c.attachment&&(c.attachment instanceof G?(c.attachment=c.attachment.newLinkedMesh(),this.setAttachment(c.slotIndex,c.name,c.attachment)):(c.attachment=c.attachment.copy(),this.setAttachment(c.slotIndex,c.name,c.attachment)))}}},{key:"getAttachment",value:function(t,e){var a=this.attachments[t];return a?a[e]:null}},{key:"removeAttachment",value:function(t,e){var a=this.attachments[t];a&&(a[e]=null)}},{key:"getAttachments",value:function(){for(var t=new Array,e=0;e<this.attachments.length;e++){var a=this.attachments[e];if(a)for(var n in a){var r=a[n];r&&t.push(new Xt(e,n,r))}}return t}},{key:"getAttachmentsForSlot",value:function(t,e){var a=this.attachments[t];if(a)for(var n in a){var r=a[n];r&&e.push(new Xt(t,n,r))}}},{key:"clear",value:function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}},{key:"attachAll",value:function(t,e){for(var a=0,n=0;n<t.slots.length;n++){var r=t.slots[n],i=r.getAttachment();if(i&&a<e.attachments.length){var s=e.attachments[a];for(var o in s)if(i==s[o]){var l=this.getAttachment(a,o);null!=l&&r.setAttachment(l);break}}a++}}}]),t}(),Bt=function t(e){n(this,t),this.name=void 0,this.intValue=void 0,this.floatValue=void 0,this.stringValue=void 0,this.audioPath=void 0,this.volume=void 0,this.balance=void 0,this.name=e};!function(t){t[t.Normal=0]="Normal",t[t.Additive=1]="Additive",t[t.Multiply=2]="Multiply",t[t.Screen=3]="Screen"}(Rt||(Rt={}));var Ut,Wt=function t(e,a){if(n(this,t),this.data=void 0,this.intValue=void 0,this.floatValue=void 0,this.stringValue=void 0,this.time=void 0,this.volume=void 0,this.balance=void 0,null==a)throw new Error("data cannot be null.");this.time=e,this.data=a},qt=function(){function t(e){n(this,t),this.attachmentLoader=void 0,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=e}return i(t,[{key:"readSkeletonData",value:function(e){var a=this.scale,n=new _t,r="string"==typeof e?JSON.parse(e):e,i=r.skeleton;if(null!=i){if(n.hash=i.hash,n.version=i.spine,"3.8.75"==n.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");n.x=i.x,n.y=i.y,n.width=i.width,n.height=i.height,n.fps=i.fps,n.imagesPath=i.images}if(r.bones)for(var s=0;s<r.bones.length;s++){var o=r.bones[s],l=null,h=this.getValue(o,"parent",null);if(null!=h&&null==(l=n.findBone(h)))throw new Error("Parent bone not found: "+h);var u=new E(n.bones.length,o.name,l);u.length=this.getValue(o,"length",0)*a,u.x=this.getValue(o,"x",0)*a,u.y=this.getValue(o,"y",0)*a,u.rotation=this.getValue(o,"rotation",0),u.scaleX=this.getValue(o,"scaleX",1),u.scaleY=this.getValue(o,"scaleY",1),u.shearX=this.getValue(o,"shearX",0),u.shearY=this.getValue(o,"shearY",0),u.transformMode=t.transformModeFromString(this.getValue(o,"transform","normal")),u.skinRequired=this.getValue(o,"skin",!1),n.bones.push(u)}if(r.slots)for(var c=0;c<r.slots.length;c++){var d=r.slots[c],f=d.name,v=d.bone,m=n.findBone(v);if(null==m)throw new Error("Slot bone not found: "+v);var p=new Ot(n.slots.length,f,m),y=this.getValue(d,"color",null);null!=y&&p.color.setFromString(y);var w=this.getValue(d,"dark",null);null!=w&&(p.darkColor=new g(1,1,1,1),p.darkColor.setFromString(w)),p.attachmentName=this.getValue(d,"attachment",null),p.blendMode=t.blendModeFromString(this.getValue(d,"blend","normal")),n.slots.push(p)}if(r.ik)for(var k=0;k<r.ik.length;k++){var M=r.ik[k],S=new Lt(M.name);S.order=this.getValue(M,"order",0),S.skinRequired=this.getValue(M,"skin",!1);for(var I=0;I<M.bones.length;I++){var A=M.bones[I],T=n.findBone(A);if(null==T)throw new Error("IK bone not found: "+A);S.bones.push(T)}var R=M.target;if(S.target=n.findBone(R),null==S.target)throw new Error("IK target bone not found: "+R);S.mix=this.getValue(M,"mix",1),S.softness=this.getValue(M,"softness",0)*a,S.bendDirection=this.getValue(M,"bendPositive",!0)?1:-1,S.compress=this.getValue(M,"compress",!1),S.stretch=this.getValue(M,"stretch",!1),S.uniform=this.getValue(M,"uniform",!1),n.ikConstraints.push(S)}if(r.transform)for(var V=0;V<r.transform.length;V++){var P=r.transform[V],F=new Dt(P.name);F.order=this.getValue(P,"order",0),F.skinRequired=this.getValue(P,"skin",!1);for(var N=0;N<P.bones.length;N++){var _=P.bones[N],O=n.findBone(_);if(null==O)throw new Error("Transform constraint bone not found: "+_);F.bones.push(O)}var L=P.target;if(F.target=n.findBone(L),null==F.target)throw new Error("Transform constraint target bone not found: "+L);F.local=this.getValue(P,"local",!1),F.relative=this.getValue(P,"relative",!1),F.offsetRotation=this.getValue(P,"rotation",0),F.offsetX=this.getValue(P,"x",0)*a,F.offsetY=this.getValue(P,"y",0)*a,F.offsetScaleX=this.getValue(P,"scaleX",0),F.offsetScaleY=this.getValue(P,"scaleY",0),F.offsetShearY=this.getValue(P,"shearY",0),F.rotateMix=this.getValue(P,"rotateMix",1),F.translateMix=this.getValue(P,"translateMix",1),F.scaleMix=this.getValue(P,"scaleMix",1),F.shearMix=this.getValue(P,"shearMix",1),n.transformConstraints.push(F)}if(r.path)for(var D=0;D<r.path.length;D++){var X=r.path[D],Y=new C(X.name);Y.order=this.getValue(X,"order",0),Y.skinRequired=this.getValue(X,"skin",!1);for(var B=0;B<X.bones.length;B++){var U=X.bones[B],W=n.findBone(U);if(null==W)throw new Error("Transform constraint bone not found: "+U);Y.bones.push(W)}var q=X.target;if(Y.target=n.findSlot(q),null==Y.target)throw new Error("Path target slot not found: "+q);Y.positionMode=t.positionModeFromString(this.getValue(X,"positionMode","percent")),Y.spacingMode=t.spacingModeFromString(this.getValue(X,"spacingMode","length")),Y.rotateMode=t.rotateModeFromString(this.getValue(X,"rotateMode","tangent")),Y.offsetRotation=this.getValue(X,"rotation",0),Y.position=this.getValue(X,"position",0),Y.positionMode==x.Fixed&&(Y.position*=a),Y.spacing=this.getValue(X,"spacing",0),Y.spacingMode!=b.Length&&Y.spacingMode!=b.Fixed||(Y.spacing*=a),Y.rotateMix=this.getValue(X,"rotateMix",1),Y.translateMix=this.getValue(X,"translateMix",1),n.pathConstraints.push(Y)}if(r.skins)for(var H=0;H<r.skins.length;H++){var j=r.skins[H],G=new Yt(j.name);if(j.bones)for(var z=0;z<j.bones.length;z++){var Z=n.findBone(j.bones[z]);if(null==Z)throw new Error("Skin bone not found: "+j.bones[H]);G.bones.push(Z)}if(j.ik)for(var Q=0;Q<j.ik.length;Q++){var J=n.findIkConstraint(j.ik[Q]);if(null==J)throw new Error("Skin IK constraint not found: "+j.ik[H]);G.constraints.push(J)}if(j.transform)for(var K=0;K<j.transform.length;K++){var $=n.findTransformConstraint(j.transform[K]);if(null==$)throw new Error("Skin transform constraint not found: "+j.transform[H]);G.constraints.push($)}if(j.path)for(var tt=0;tt<j.path.length;tt++){var et=n.findPathConstraint(j.path[tt]);if(null==et)throw new Error("Skin path constraint not found: "+j.path[H]);G.constraints.push(et)}for(var at in j.attachments){var nt=n.findSlot(at);if(null==nt)throw new Error("Slot not found: "+at);var rt=j.attachments[at];for(var it in rt){var st=this.readAttachment(rt[it],G,nt.index,it,n);null!=st&&G.setAttachment(nt.index,it,st)}}n.skins.push(G),"default"==G.name&&(n.defaultSkin=G)}for(var ot=0,lt=this.linkedMeshes.length;ot<lt;ot++){var ht=this.linkedMeshes[ot],ut=null==ht.skin?n.defaultSkin:n.findSkin(ht.skin);if(null==ut)throw new Error("Skin not found: "+ht.skin);var ct=ut.getAttachment(ht.slotIndex,ht.parent);if(null==ct)throw new Error("Parent mesh not found: "+ht.parent);ht.mesh.deformAttachment=ht.inheritDeform?ct:ht.mesh,ht.mesh.setParentMesh(ct),ht.mesh.updateUVs()}if(this.linkedMeshes.length=0,r.events)for(var dt in r.events){var ft=r.events[dt],vt=new Bt(dt);vt.intValue=this.getValue(ft,"int",0),vt.floatValue=this.getValue(ft,"float",0),vt.stringValue=this.getValue(ft,"string",""),vt.audioPath=this.getValue(ft,"audio",null),null!=vt.audioPath&&(vt.volume=this.getValue(ft,"volume",1),vt.balance=this.getValue(ft,"balance",0)),n.events.push(vt)}if(r.animations)for(var gt in r.animations){var mt=r.animations[gt];this.readAnimation(mt,gt,n)}return n}},{key:"readAttachment",value:function(t,e,a,n,r){var i=this.scale;switch(n=this.getValue(t,"name",n),this.getValue(t,"type","region")){case"region":var s=this.getValue(t,"path",n),o=this.attachmentLoader.newRegionAttachment(e,n,s);if(null==o)return null;o.path=s,o.x=this.getValue(t,"x",0)*i,o.y=this.getValue(t,"y",0)*i,o.scaleX=this.getValue(t,"scaleX",1),o.scaleY=this.getValue(t,"scaleY",1),o.rotation=this.getValue(t,"rotation",0),o.width=t.width*i,o.height=t.height*i;var l=this.getValue(t,"color",null);return null!=l&&o.color.setFromString(l),o.updateOffset(),o;case"boundingbox":var h=this.attachmentLoader.newBoundingBoxAttachment(e,n);if(null==h)return null;this.readVertices(t,h,t.vertexCount<<1);var u=this.getValue(t,"color",null);return null!=u&&h.color.setFromString(u),h;case"mesh":case"linkedmesh":var c=this.getValue(t,"path",n),d=this.attachmentLoader.newMeshAttachment(e,n,c);if(null==d)return null;d.path=c;var f=this.getValue(t,"color",null);null!=f&&d.color.setFromString(f),d.width=this.getValue(t,"width",0)*i,d.height=this.getValue(t,"height",0)*i;var v=this.getValue(t,"parent",null);if(null!=v)return this.linkedMeshes.push(new Ht(d,this.getValue(t,"skin",null),a,v,this.getValue(t,"deform",!0))),d;var g=t.uvs;return this.readVertices(t,d,g.length),d.triangles=t.triangles,d.regionUVs=g,d.updateUVs(),d.edges=this.getValue(t,"edges",null),d.hullLength=2*this.getValue(t,"hull",0),d;case"path":var m=this.attachmentLoader.newPathAttachment(e,n);if(null==m)return null;m.closed=this.getValue(t,"closed",!1),m.constantSpeed=this.getValue(t,"constantSpeed",!0);var y=t.vertexCount;this.readVertices(t,m,y<<1);for(var w=p.newArray(y/3,0),k=0;k<t.lengths.length;k++)w[k]=t.lengths[k]*i;m.lengths=w;var E=this.getValue(t,"color",null);return null!=E&&m.color.setFromString(E),m;case"point":var x=this.attachmentLoader.newPointAttachment(e,n);if(null==x)return null;x.x=this.getValue(t,"x",0)*i,x.y=this.getValue(t,"y",0)*i,x.rotation=this.getValue(t,"rotation",0);var b=this.getValue(t,"color",null);return null!=b&&x.color.setFromString(b),x;case"clipping":var M=this.attachmentLoader.newClippingAttachment(e,n);if(null==M)return null;var S=this.getValue(t,"end",null);if(null!=S){var I=r.findSlot(S);if(null==I)throw new Error("Clipping end slot not found: "+S);M.endSlot=I}var A=t.vertexCount;this.readVertices(t,M,A<<1);var T=this.getValue(t,"color",null);return null!=T&&M.color.setFromString(T),M}return null}},{key:"readVertices",value:function(t,e,a){var n=this.scale;e.worldVerticesLength=a;var r=t.vertices;if(a!=r.length){for(var i=new Array,s=new Array,o=0,l=r.length;o<l;){var h=r[o++];s.push(h);for(var u=o+4*h;o<u;o+=4)s.push(r[o]),i.push(r[o+1]*n),i.push(r[o+2]*n),i.push(r[o+3])}e.bones=s,e.vertices=p.toFloatArray(i)}else{var c=p.toFloatArray(r);if(1!=n)for(var d=0,f=r.length;d<f;d++)c[d]*=n;e.vertices=c}}},{key:"readAnimation",value:function(t,e,a){var n=this.scale,r=new Array,i=0;if(t.slots)for(var s in t.slots){var o=t.slots[s],l=a.findSlotIndex(s);if(-1==l)throw new Error("Slot not found: "+s);for(var h in o){var u=o[h];if("attachment"==h){var c=new nt(u.length);c.slotIndex=l;for(var d=0,f=0;f<u.length;f++){var v=u[f];c.setFrame(d++,this.getValue(v,"time",0),v.name)}r.push(c),i=Math.max(i,c.frames[c.getFrameCount()-1])}else if("color"==h){var m=new et(u.length);m.slotIndex=l;for(var y=0,w=0;w<u.length;w++){var k=u[w],E=new g;E.setFromString(k.color),m.setFrame(y,this.getValue(k,"time",0),E.r,E.g,E.b,E.a),this.readCurve(k,m,y),y++}r.push(m),i=Math.max(i,m.frames[(m.getFrameCount()-1)*et.ENTRIES])}else{if("twoColor"!=h)throw new Error("Invalid timeline type for a slot: "+h+" ("+s+")");var M=new at(u.length);M.slotIndex=l;for(var S=0,I=0;I<u.length;I++){var A=u[I],T=new g,R=new g;T.setFromString(A.light),R.setFromString(A.dark),M.setFrame(S,this.getValue(A,"time",0),T.r,T.g,T.b,T.a,R.r,R.g,R.b),this.readCurve(A,M,S),S++}r.push(M),i=Math.max(i,M.frames[(M.getFrameCount()-1)*at.ENTRIES])}}}if(t.bones)for(var C in t.bones){var V=t.bones[C],P=a.findBoneIndex(C);if(-1==P)throw new Error("Bone not found: "+C);for(var F in V){var N=V[F];if("rotate"===F){var _=new J(N.length);_.boneIndex=P;for(var O=0,L=0;L<N.length;L++){var D=N[L];_.setFrame(O,this.getValue(D,"time",0),this.getValue(D,"angle",0)),this.readCurve(D,_,O),O++}r.push(_),i=Math.max(i,_.frames[(_.getFrameCount()-1)*J.ENTRIES])}else{if("translate"!==F&&"scale"!==F&&"shear"!==F)throw new Error("Invalid timeline type for a bone: "+F+" ("+C+")");var X=null,Y=1,B=0;"scale"===F?(X=new $(N.length),B=1):"shear"===F?X=new tt(N.length):(X=new K(N.length),Y=n),X.boneIndex=P;for(var U=0,W=0;W<N.length;W++){var q=N[W],H=this.getValue(q,"x",B),j=this.getValue(q,"y",B);X.setFrame(U,this.getValue(q,"time",0),H*Y,j*Y),this.readCurve(q,X,U),U++}r.push(X),i=Math.max(i,X.frames[(X.getFrameCount()-1)*K.ENTRIES])}}}if(t.ik)for(var G in t.ik){var z=t.ik[G],Q=a.findIkConstraint(G),rt=new lt(z.length);rt.ikConstraintIndex=a.ikConstraints.indexOf(Q);for(var ft=0,vt=0;vt<z.length;vt++){var gt=z[vt];rt.setFrame(ft,this.getValue(gt,"time",0),this.getValue(gt,"mix",1),this.getValue(gt,"softness",0)*n,this.getValue(gt,"bendPositive",!0)?1:-1,this.getValue(gt,"compress",!1),this.getValue(gt,"stretch",!1)),this.readCurve(gt,rt,ft),ft++}r.push(rt),i=Math.max(i,rt.frames[(rt.getFrameCount()-1)*lt.ENTRIES])}if(t.transform)for(var mt in t.transform){var pt=t.transform[mt],yt=a.findTransformConstraint(mt),wt=new ht(pt.length);wt.transformConstraintIndex=a.transformConstraints.indexOf(yt);for(var kt=0,Et=0;Et<pt.length;Et++){var xt=pt[Et];wt.setFrame(kt,this.getValue(xt,"time",0),this.getValue(xt,"rotateMix",1),this.getValue(xt,"translateMix",1),this.getValue(xt,"scaleMix",1),this.getValue(xt,"shearMix",1)),this.readCurve(xt,wt,kt),kt++}r.push(wt),i=Math.max(i,wt.frames[(wt.getFrameCount()-1)*ht.ENTRIES])}if(t.path)for(var bt in t.path){var Mt=t.path[bt],St=a.findPathConstraintIndex(bt);if(-1==St)throw new Error("Path constraint not found: "+bt);var It=a.pathConstraints[St];for(var At in Mt){var Tt=Mt[At];if("position"===At||"spacing"===At){var Rt=null,Ct=1;"spacing"===At?(Rt=new ct(Tt.length),It.spacingMode!=b.Length&&It.spacingMode!=b.Fixed||(Ct=n)):(Rt=new ut(Tt.length),It.positionMode==x.Fixed&&(Ct=n)),Rt.pathConstraintIndex=St;for(var Vt=0,Pt=0;Pt<Tt.length;Pt++){var Ft=Tt[Pt];Rt.setFrame(Vt,this.getValue(Ft,"time",0),this.getValue(Ft,At,0)*Ct),this.readCurve(Ft,Rt,Vt),Vt++}r.push(Rt),i=Math.max(i,Rt.frames[(Rt.getFrameCount()-1)*ut.ENTRIES])}else if("mix"===At){var Nt=new dt(Tt.length);Nt.pathConstraintIndex=St;for(var _t=0,Ot=0;Ot<Tt.length;Ot++){var Lt=Tt[Ot];Nt.setFrame(_t,this.getValue(Lt,"time",0),this.getValue(Lt,"rotateMix",1),this.getValue(Lt,"translateMix",1)),this.readCurve(Lt,Nt,_t),_t++}r.push(Nt),i=Math.max(i,Nt.frames[(Nt.getFrameCount()-1)*dt.ENTRIES])}}}if(t.deform)for(var Dt in t.deform){var Xt=t.deform[Dt],Yt=a.findSkin(Dt);if(null==Yt)throw new Error("Skin not found: "+Dt);for(var Bt in Xt){var Ut=Xt[Bt],qt=a.findSlotIndex(Bt);if(-1==qt)throw new Error("Slot not found: "+Ut.name);for(var Ht in Ut){var jt=Ut[Ht],Gt=Yt.getAttachment(qt,Ht);if(null==Gt)throw new Error("Deform attachment not found: "+jt.name);var zt=null!=Gt.bones,Zt=Gt.vertices,Qt=zt?Zt.length/3*2:Zt.length,Jt=new it(jt.length);Jt.slotIndex=qt,Jt.attachment=Gt;for(var Kt=0,$t=0;$t<jt.length;$t++){var te=jt[$t],ee=void 0,ae=this.getValue(te,"vertices",null);if(null==ae)ee=zt?p.newFloatArray(Qt):Zt;else{ee=p.newFloatArray(Qt);var ne=this.getValue(te,"offset",0);if(p.arrayCopy(ae,0,ee,ne,ae.length),1!=n)for(var re=ne,ie=re+ae.length;re<ie;re++)ee[re]*=n;if(!zt)for(var se=0;se<Qt;se++)ee[se]+=Zt[se]}Jt.setFrame(Kt,this.getValue(te,"time",0),ee),this.readCurve(te,Jt,Kt),Kt++}r.push(Jt),i=Math.max(i,Jt.frames[Jt.getFrameCount()-1])}}}var oe=t.drawOrder;if(null==oe&&(oe=t.draworder),null!=oe){for(var le=new ot(oe.length),he=a.slots.length,ue=0,ce=0;ce<oe.length;ce++){var de=oe[ce],fe=null,ve=this.getValue(de,"offsets",null);if(null!=ve){fe=p.newArray(he,-1);for(var ge=p.newArray(he-ve.length,0),me=0,pe=0,ye=0;ye<ve.length;ye++){var we=ve[ye],ke=a.findSlotIndex(we.slot);if(-1==ke)throw new Error("Slot not found: "+we.slot);for(;me!=ke;)ge[pe++]=me++;fe[me+we.offset]=me++}for(;me<he;)ge[pe++]=me++;for(var Ee=he-1;Ee>=0;Ee--)-1==fe[Ee]&&(fe[Ee]=ge[--pe])}le.setFrame(ue++,this.getValue(de,"time",0),fe)}r.push(le),i=Math.max(i,le.frames[le.getFrameCount()-1])}if(t.events){for(var xe=new st(t.events.length),be=0,Me=0;Me<t.events.length;Me++){var Se=t.events[Me],Ie=a.findEvent(Se.name);if(null==Ie)throw new Error("Event not found: "+Se.name);var Ae=new Wt(p.toSinglePrecision(this.getValue(Se,"time",0)),Ie);Ae.intValue=this.getValue(Se,"int",Ie.intValue),Ae.floatValue=this.getValue(Se,"float",Ie.floatValue),Ae.stringValue=this.getValue(Se,"string",Ie.stringValue),null!=Ae.data.audioPath&&(Ae.volume=this.getValue(Se,"volume",1),Ae.balance=this.getValue(Se,"balance",0)),xe.setFrame(be++,Ae)}r.push(xe),i=Math.max(i,xe.frames[xe.getFrameCount()-1])}if(isNaN(i))throw new Error("Error while parsing animation, duration is NaN");a.animations.push(new Z(e,r,i))}},{key:"readCurve",value:function(t,e,a){if(t.hasOwnProperty("curve"))if("stepped"==t.curve)e.setStepped(a);else{var n=t.curve;e.setCurve(a,n,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))}}},{key:"getValue",value:function(t,e,a){return void 0!==t[e]?t[e]:a}}],[{key:"blendModeFromString",value:function(t){if("normal"==(t=t.toLowerCase()))return Rt.Normal;if("additive"==t)return Rt.Additive;if("multiply"==t)return Rt.Multiply;if("screen"==t)return Rt.Screen;throw new Error("Unknown blend mode: ".concat(t))}},{key:"positionModeFromString",value:function(t){if("fixed"==(t=t.toLowerCase()))return x.Fixed;if("percent"==t)return x.Percent;throw new Error("Unknown position mode: ".concat(t))}},{key:"spacingModeFromString",value:function(t){if("length"==(t=t.toLowerCase()))return b.Length;if("fixed"==t)return b.Fixed;if("percent"==t)return b.Percent;throw new Error("Unknown position mode: ".concat(t))}},{key:"rotateModeFromString",value:function(t){if("tangent"==(t=t.toLowerCase()))return M.Tangent;if("chain"==t)return M.Chain;if("chainscale"==t)return M.ChainScale;throw new Error("Unknown rotate mode: ".concat(t))}},{key:"transformModeFromString",value:function(t){if("normal"==(t=t.toLowerCase()))return y.Normal;if("onlytranslation"==t)return y.OnlyTranslation;if("norotationorreflection"==t)return y.NoRotationOrReflection;if("noscale"==t)return y.NoScale;if("noscaleorreflection"==t)return y.NoScaleOrReflection;throw new Error("Unknown transform mode: ".concat(t))}}]),t}(),Ht=function t(e,a,r,i,s){n(this,t),this.parent=void 0,this.skin=void 0,this.slotIndex=void 0,this.mesh=void 0,this.inheritDeform=void 0,this.mesh=e,this.skin=a,this.slotIndex=r,this.parent=i,this.inheritDeform=s};!function(t){t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point",t[t.Clipping=6]="Clipping"}(Ut||(Ut={}));var jt=function(){function t(e){n(this,t),this.scale=1,this.attachmentLoader=void 0,this.linkedMeshes=new Array,this.attachmentLoader=e}return i(t,[{key:"readSkeletonData",value:function(e){var a=this.scale,n=new _t;n.name="";var r=new Gt(e);if(n.hash=r.readString(),n.version=r.readString(),"3.8.75"==n.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");n.x=r.readFloat(),n.y=r.readFloat(),n.width=r.readFloat(),n.height=r.readFloat();var i=r.readBoolean();i&&(n.fps=r.readFloat(),n.imagesPath=r.readString(),n.audioPath=r.readString());var s=0;s=r.readInt(!0);for(var o=0;o<s;o++)r.strings.push(r.readString());s=r.readInt(!0);for(var l=0;l<s;l++){var h=r.readString(),u=0==l?null:n.bones[r.readInt(!0)],c=new E(l,h,u);c.rotation=r.readFloat(),c.x=r.readFloat()*a,c.y=r.readFloat()*a,c.scaleX=r.readFloat(),c.scaleY=r.readFloat(),c.shearX=r.readFloat(),c.shearY=r.readFloat(),c.length=r.readFloat()*a,c.transformMode=t.TransformModeValues[r.readInt(!0)],c.skinRequired=r.readBoolean(),i&&g.rgba8888ToColor(c.color,r.readInt32()),n.bones.push(c)}s=r.readInt(!0);for(var d=0;d<s;d++){var f=r.readString(),v=n.bones[r.readInt(!0)],m=new Ot(d,f,v);g.rgba8888ToColor(m.color,r.readInt32());var y=r.readInt32();-1!=y&&g.rgb888ToColor(m.darkColor=new g,y),m.attachmentName=r.readStringRef(),m.blendMode=t.BlendModeValues[r.readInt(!0)],n.slots.push(m)}s=r.readInt(!0);for(var w,k=0;k<s;k++){var M=new Lt(r.readString());M.order=r.readInt(!0),M.skinRequired=r.readBoolean(),w=r.readInt(!0);for(var S=0;S<w;S++)M.bones.push(n.bones[r.readInt(!0)]);M.target=n.bones[r.readInt(!0)],M.mix=r.readFloat(),M.softness=r.readFloat()*a,M.bendDirection=r.readByte(),M.compress=r.readBoolean(),M.stretch=r.readBoolean(),M.uniform=r.readBoolean(),n.ikConstraints.push(M)}s=r.readInt(!0);for(var I,A=0;A<s;A++){var T=new Dt(r.readString());T.order=r.readInt(!0),T.skinRequired=r.readBoolean(),I=r.readInt(!0);for(var R=0;R<I;R++)T.bones.push(n.bones[r.readInt(!0)]);T.target=n.bones[r.readInt(!0)],T.local=r.readBoolean(),T.relative=r.readBoolean(),T.offsetRotation=r.readFloat(),T.offsetX=r.readFloat()*a,T.offsetY=r.readFloat()*a,T.offsetScaleX=r.readFloat(),T.offsetScaleY=r.readFloat(),T.offsetShearY=r.readFloat(),T.rotateMix=r.readFloat(),T.translateMix=r.readFloat(),T.scaleMix=r.readFloat(),T.shearMix=r.readFloat(),n.transformConstraints.push(T)}s=r.readInt(!0);for(var V,P=0;P<s;P++){var F=new C(r.readString());F.order=r.readInt(!0),F.skinRequired=r.readBoolean(),V=r.readInt(!0);for(var N=0;N<V;N++)F.bones.push(n.bones[r.readInt(!0)]);F.target=n.slots[r.readInt(!0)],F.positionMode=t.PositionModeValues[r.readInt(!0)],F.spacingMode=t.SpacingModeValues[r.readInt(!0)],F.rotateMode=t.RotateModeValues[r.readInt(!0)],F.offsetRotation=r.readFloat(),F.position=r.readFloat(),F.positionMode==x.Fixed&&(F.position*=a),F.spacing=r.readFloat(),F.spacingMode!=b.Length&&F.spacingMode!=b.Fixed||(F.spacing*=a),F.rotateMix=r.readFloat(),F.translateMix=r.readFloat(),n.pathConstraints.push(F)}var _=this.readSkin(r,n,!0,i);null!=_&&(n.defaultSkin=_,n.skins.push(_));var O=n.skins.length;for(p.setArraySize(n.skins,s=O+r.readInt(!0));O<s;O++)n.skins[O]=this.readSkin(r,n,!1,i);s=this.linkedMeshes.length;for(var L=0;L<s;L++){var D=this.linkedMeshes[L],X=null==D.skin?n.defaultSkin:n.findSkin(D.skin);if(null==X)throw new Error("Skin not found: "+D.skin);var Y=X.getAttachment(D.slotIndex,D.parent);if(null==Y)throw new Error("Parent mesh not found: "+D.parent);D.mesh.deformAttachment=D.inheritDeform?Y:D.mesh,D.mesh.setParentMesh(Y),D.mesh.updateUVs()}this.linkedMeshes.length=0,s=r.readInt(!0);for(var B=0;B<s;B++){var U=new Bt(r.readStringRef());U.intValue=r.readInt(!1),U.floatValue=r.readFloat(),U.stringValue=r.readString(),U.audioPath=r.readString(),null!=U.audioPath&&(U.volume=r.readFloat(),U.balance=r.readFloat()),n.events.push(U)}s=r.readInt(!0);for(var W=0;W<s;W++)n.animations.push(this.readAnimation(r,r.readString(),n));return n}},{key:"readSkin",value:function(t,e,a,n){var r=null,i=0;if(a){if(0==(i=t.readInt(!0)))return null;r=new Yt("default")}else{(r=new Yt(t.readStringRef())).bones.length=t.readInt(!0);for(var s=0,o=r.bones.length;s<o;s++)r.bones[s]=e.bones[t.readInt(!0)];for(var l=0,h=t.readInt(!0);l<h;l++)r.constraints.push(e.ikConstraints[t.readInt(!0)]);for(var u=0,c=t.readInt(!0);u<c;u++)r.constraints.push(e.transformConstraints[t.readInt(!0)]);for(var d=0,f=t.readInt(!0);d<f;d++)r.constraints.push(e.pathConstraints[t.readInt(!0)]);i=t.readInt(!0)}for(var v=0;v<i;v++)for(var g=t.readInt(!0),m=0,p=t.readInt(!0);m<p;m++){var y=t.readStringRef(),w=this.readAttachment(t,e,r,g,y,n);null!=w&&r.setAttachment(g,y,w)}return r}},{key:"readAttachment",value:function(e,a,n,r,i,s){var o=this.scale,l=e.readStringRef();null==l&&(l=i);var h=e.readByte();switch(t.AttachmentTypeValues[h]){case Ut.Region:var u=e.readStringRef(),c=e.readFloat(),d=e.readFloat(),f=e.readFloat(),v=e.readFloat(),m=e.readFloat(),y=e.readFloat(),w=e.readFloat(),k=e.readInt32();null==u&&(u=l);var E=this.attachmentLoader.newRegionAttachment(n,l,u);return null==E?null:(E.path=u,E.x=d*o,E.y=f*o,E.scaleX=v,E.scaleY=m,E.rotation=c,E.width=y*o,E.height=w*o,g.rgba8888ToColor(E.color,k),E.updateOffset(),E);case Ut.BoundingBox:var x=e.readInt(!0),b=this.readVertices(e,x),M=s?e.readInt32():0,S=this.attachmentLoader.newBoundingBoxAttachment(n,l);return null==S?null:(S.worldVerticesLength=x<<1,S.vertices=b.vertices,S.bones=b.bones,s&&g.rgba8888ToColor(S.color,M),S);case Ut.Mesh:var I=e.readStringRef(),A=e.readInt32(),T=e.readInt(!0),R=this.readFloatArray(e,T<<1,1),C=this.readShortArray(e),V=this.readVertices(e,T),P=e.readInt(!0),F=null,N=0,_=0;s&&(F=this.readShortArray(e),N=e.readFloat(),_=e.readFloat()),null==I&&(I=l);var O=this.attachmentLoader.newMeshAttachment(n,l,I);return null==O?null:(O.path=I,g.rgba8888ToColor(O.color,A),O.bones=V.bones,O.vertices=V.vertices,O.worldVerticesLength=T<<1,O.triangles=C,O.regionUVs=R,O.updateUVs(),O.hullLength=P<<1,s&&(O.edges=F,O.width=N*o,O.height=_*o),O);case Ut.LinkedMesh:var L=e.readStringRef(),D=e.readInt32(),X=e.readStringRef(),Y=e.readStringRef(),B=e.readBoolean(),U=0,W=0;s&&(U=e.readFloat(),W=e.readFloat()),null==L&&(L=l);var q=this.attachmentLoader.newMeshAttachment(n,l,L);return null==q?null:(q.path=L,g.rgba8888ToColor(q.color,D),s&&(q.width=U*o,q.height=W*o),this.linkedMeshes.push(new zt(q,X,r,Y,B)),q);case Ut.Path:for(var H=e.readBoolean(),j=e.readBoolean(),G=e.readInt(!0),z=this.readVertices(e,G),Z=p.newArray(G/3,0),Q=0,J=Z.length;Q<J;Q++)Z[Q]=e.readFloat()*o;var K=s?e.readInt32():0,$=this.attachmentLoader.newPathAttachment(n,l);return null==$?null:($.closed=H,$.constantSpeed=j,$.worldVerticesLength=G<<1,$.vertices=z.vertices,$.bones=z.bones,$.lengths=Z,s&&g.rgba8888ToColor($.color,K),$);case Ut.Point:var tt=e.readFloat(),et=e.readFloat(),at=e.readFloat(),nt=s?e.readInt32():0,rt=this.attachmentLoader.newPointAttachment(n,l);return null==rt?null:(rt.x=et*o,rt.y=at*o,rt.rotation=tt,s&&g.rgba8888ToColor(rt.color,nt),rt);case Ut.Clipping:var it=e.readInt(!0),st=e.readInt(!0),ot=this.readVertices(e,st),lt=s?e.readInt32():0,ht=this.attachmentLoader.newClippingAttachment(n,l);return null==ht?null:(ht.endSlot=a.slots[it],ht.worldVerticesLength=st<<1,ht.vertices=ot.vertices,ht.bones=ot.bones,s&&g.rgba8888ToColor(ht.color,lt),ht)}return null}},{key:"readVertices",value:function(t,e){var a=e<<1,n=new Zt,r=this.scale;if(!t.readBoolean())return n.vertices=this.readFloatArray(t,a,r),n;for(var i=new Array,s=new Array,o=0;o<e;o++){var l=t.readInt(!0);s.push(l);for(var h=0;h<l;h++)s.push(t.readInt(!0)),i.push(t.readFloat()*r),i.push(t.readFloat()*r),i.push(t.readFloat())}return n.vertices=p.toFloatArray(i),n.bones=s,n}},{key:"readFloatArray",value:function(t,e,a){var n=new Array(e);if(1==a)for(var r=0;r<e;r++)n[r]=t.readFloat();else for(var i=0;i<e;i++)n[i]=t.readFloat()*a;return n}},{key:"readShortArray",value:function(t){for(var e=t.readInt(!0),a=new Array(e),n=0;n<e;n++)a[n]=t.readShort();return a}},{key:"readAnimation",value:function(e,a,n){for(var r=new Array,i=this.scale,s=0,o=new g,l=new g,h=0,u=e.readInt(!0);h<u;h++)for(var c=e.readInt(!0),d=0,f=e.readInt(!0);d<f;d++){var v=e.readByte(),m=e.readInt(!0);switch(v){case t.SLOT_ATTACHMENT:var y=new nt(m);y.slotIndex=c;for(var w=0;w<m;w++)y.setFrame(w,e.readFloat(),e.readStringRef());r.push(y),s=Math.max(s,y.frames[m-1]);break;case t.SLOT_COLOR:var k=new et(m);k.slotIndex=c;for(var E=0;E<m;E++){var M=e.readFloat();g.rgba8888ToColor(o,e.readInt32()),k.setFrame(E,M,o.r,o.g,o.b,o.a),E<m-1&&this.readCurve(e,E,k)}r.push(k),s=Math.max(s,k.frames[(m-1)*et.ENTRIES]);break;case t.SLOT_TWO_COLOR:var S=new at(m);S.slotIndex=c;for(var I=0;I<m;I++){var A=e.readFloat();g.rgba8888ToColor(o,e.readInt32()),g.rgb888ToColor(l,e.readInt32()),S.setFrame(I,A,o.r,o.g,o.b,o.a,l.r,l.g,l.b),I<m-1&&this.readCurve(e,I,S)}r.push(S),s=Math.max(s,S.frames[(m-1)*at.ENTRIES])}}for(var T=0,R=e.readInt(!0);T<R;T++)for(var C=e.readInt(!0),V=0,P=e.readInt(!0);V<P;V++){var F=e.readByte(),N=e.readInt(!0);switch(F){case t.BONE_ROTATE:var _=new J(N);_.boneIndex=C;for(var O=0;O<N;O++)_.setFrame(O,e.readFloat(),e.readFloat()),O<N-1&&this.readCurve(e,O,_);r.push(_),s=Math.max(s,_.frames[(N-1)*J.ENTRIES]);break;case t.BONE_TRANSLATE:case t.BONE_SCALE:case t.BONE_SHEAR:var L=void 0,D=1;F==t.BONE_SCALE?L=new $(N):F==t.BONE_SHEAR?L=new tt(N):(L=new K(N),D=i),L.boneIndex=C;for(var X=0;X<N;X++)L.setFrame(X,e.readFloat(),e.readFloat()*D,e.readFloat()*D),X<N-1&&this.readCurve(e,X,L);r.push(L),s=Math.max(s,L.frames[(N-1)*K.ENTRIES])}}for(var Y=0,B=e.readInt(!0);Y<B;Y++){var U=e.readInt(!0),W=e.readInt(!0),q=new lt(W);q.ikConstraintIndex=U;for(var H=0;H<W;H++)q.setFrame(H,e.readFloat(),e.readFloat(),e.readFloat()*i,e.readByte(),e.readBoolean(),e.readBoolean()),H<W-1&&this.readCurve(e,H,q);r.push(q),s=Math.max(s,q.frames[(W-1)*lt.ENTRIES])}for(var j=0,G=e.readInt(!0);j<G;j++){var z=e.readInt(!0),Q=e.readInt(!0),rt=new ht(Q);rt.transformConstraintIndex=z;for(var ft=0;ft<Q;ft++)rt.setFrame(ft,e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat()),ft<Q-1&&this.readCurve(e,ft,rt);r.push(rt),s=Math.max(s,rt.frames[(Q-1)*ht.ENTRIES])}for(var vt=0,gt=e.readInt(!0);vt<gt;vt++)for(var mt=e.readInt(!0),pt=n.pathConstraints[mt],yt=0,wt=e.readInt(!0);yt<wt;yt++){var kt=e.readByte(),Et=e.readInt(!0);switch(kt){case t.PATH_POSITION:case t.PATH_SPACING:var xt=void 0,bt=1;kt==t.PATH_SPACING?(xt=new ct(Et),pt.spacingMode!=b.Length&&pt.spacingMode!=b.Fixed||(bt=i)):(xt=new ut(Et),pt.positionMode==x.Fixed&&(bt=i)),xt.pathConstraintIndex=mt;for(var Mt=0;Mt<Et;Mt++)xt.setFrame(Mt,e.readFloat(),e.readFloat()*bt),Mt<Et-1&&this.readCurve(e,Mt,xt);r.push(xt),s=Math.max(s,xt.frames[(Et-1)*ut.ENTRIES]);break;case t.PATH_MIX:var St=new dt(Et);St.pathConstraintIndex=mt;for(var It=0;It<Et;It++)St.setFrame(It,e.readFloat(),e.readFloat(),e.readFloat()),It<Et-1&&this.readCurve(e,It,St);r.push(St),s=Math.max(s,St.frames[(Et-1)*dt.ENTRIES])}}for(var At=0,Tt=e.readInt(!0);At<Tt;At++)for(var Rt=n.skins[e.readInt(!0)],Ct=0,Vt=e.readInt(!0);Ct<Vt;Ct++)for(var Pt=e.readInt(!0),Ft=0,Nt=e.readInt(!0);Ft<Nt;Ft++){var _t=Rt.getAttachment(Pt,e.readStringRef()),Ot=null!=_t.bones,Lt=_t.vertices,Dt=Ot?Lt.length/3*2:Lt.length,Xt=e.readInt(!0),Yt=new it(Xt);Yt.slotIndex=Pt,Yt.attachment=_t;for(var Bt=0;Bt<Xt;Bt++){var Ut=e.readFloat(),qt=void 0,Ht=e.readInt(!0);if(0==Ht)qt=Ot?p.newFloatArray(Dt):Lt;else{qt=p.newFloatArray(Dt);var jt=e.readInt(!0);if(Ht+=jt,1==i)for(var Gt=jt;Gt<Ht;Gt++)qt[Gt]=e.readFloat();else for(var zt=jt;zt<Ht;zt++)qt[zt]=e.readFloat()*i;if(!Ot)for(var Zt=0,Qt=qt.length;Zt<Qt;Zt++)qt[Zt]+=Lt[Zt]}Yt.setFrame(Bt,Ut,qt),Bt<Xt-1&&this.readCurve(e,Bt,Yt)}r.push(Yt),s=Math.max(s,Yt.frames[Xt-1])}var Jt=e.readInt(!0);if(Jt>0){for(var Kt=new ot(Jt),$t=n.slots.length,te=0;te<Jt;te++){for(var ee=e.readFloat(),ae=e.readInt(!0),ne=p.newArray($t,0),re=$t-1;re>=0;re--)ne[re]=-1;for(var ie=p.newArray($t-ae,0),se=0,oe=0,le=0;le<ae;le++){for(var he=e.readInt(!0);se!=he;)ie[oe++]=se++;ne[se+e.readInt(!0)]=se++}for(;se<$t;)ie[oe++]=se++;for(var ue=$t-1;ue>=0;ue--)-1==ne[ue]&&(ne[ue]=ie[--oe]);Kt.setFrame(te,ee,ne)}r.push(Kt),s=Math.max(s,Kt.frames[Jt-1])}var ce=e.readInt(!0);if(ce>0){for(var de=new st(ce),fe=0;fe<ce;fe++){var ve=e.readFloat(),ge=n.events[e.readInt(!0)],me=new Wt(ve,ge);me.intValue=e.readInt(!1),me.floatValue=e.readFloat(),me.stringValue=e.readBoolean()?e.readString():ge.stringValue,null!=me.data.audioPath&&(me.volume=e.readFloat(),me.balance=e.readFloat()),de.setFrame(fe,me)}r.push(de),s=Math.max(s,de.frames[ce-1])}return new Z(a,r,s)}},{key:"readCurve",value:function(e,a,n){switch(e.readByte()){case t.CURVE_STEPPED:n.setStepped(a);break;case t.CURVE_BEZIER:this.setCurve(n,a,e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat())}}},{key:"setCurve",value:function(t,e,a,n,r,i){t.setCurve(e,a,n,r,i)}}]),t}();jt.AttachmentTypeValues=[0,1,2,3,4,5,6],jt.TransformModeValues=[y.Normal,y.OnlyTranslation,y.NoRotationOrReflection,y.NoScale,y.NoScaleOrReflection],jt.PositionModeValues=[x.Fixed,x.Percent],jt.SpacingModeValues=[b.Length,b.Fixed,b.Percent],jt.RotateModeValues=[M.Tangent,M.Chain,M.ChainScale],jt.BlendModeValues=[Rt.Normal,Rt.Additive,Rt.Multiply,Rt.Screen],jt.BONE_ROTATE=0,jt.BONE_TRANSLATE=1,jt.BONE_SCALE=2,jt.BONE_SHEAR=3,jt.SLOT_ATTACHMENT=0,jt.SLOT_COLOR=1,jt.SLOT_TWO_COLOR=2,jt.PATH_POSITION=0,jt.PATH_SPACING=1,jt.PATH_MIX=2,jt.CURVE_LINEAR=0,jt.CURVE_STEPPED=1,jt.CURVE_BEZIER=2;var Gt=function(){function t(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new DataView(e.buffer);n(this,t),this.strings=a,this.index=r,this.buffer=i}return i(t,[{key:"readByte",value:function(){return this.buffer.getInt8(this.index++)}},{key:"readShort",value:function(){var t=this.buffer.getInt16(this.index);return this.index+=2,t}},{key:"readInt32",value:function(){var t=this.buffer.getInt32(this.index);return this.index+=4,t}},{key:"readInt",value:function(t){var e=this.readByte(),a=127&e;return 0!=(128&e)&&(a|=(127&(e=this.readByte()))<<7,0!=(128&e)&&(a|=(127&(e=this.readByte()))<<14,0!=(128&e)&&(a|=(127&(e=this.readByte()))<<21,0!=(128&e)&&(a|=(127&(e=this.readByte()))<<28)))),t?a:a>>>1^-(1&a)}},{key:"readStringRef",value:function(){var t=this.readInt(!0);return 0==t?null:this.strings[t-1]}},{key:"readString",value:function(){var t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;for(var e="",a=0;a<t;){var n=this.readByte();switch(n>>4){case 12:case 13:e+=String.fromCharCode((31&n)<<6|63&this.readByte()),a+=2;break;case 14:e+=String.fromCharCode((15&n)<<12|(63&this.readByte())<<6|63&this.readByte()),a+=3;break;default:e+=String.fromCharCode(n),a++}}return e}},{key:"readFloat",value:function(){var t=this.buffer.getFloat32(this.index);return this.index+=4,t}},{key:"readBoolean",value:function(){return 0!=this.readByte()}}]),t}(),zt=function t(e,a,r,i,s){n(this,t),this.parent=void 0,this.skin=void 0,this.slotIndex=void 0,this.mesh=void 0,this.inheritDeform=void 0,this.mesh=e,this.skin=a,this.slotIndex=r,this.parent=i,this.inheritDeform=s},Zt=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n(this,t),this.bones=e,this.vertices=a};e.Shader.create("spine_skeleton","\n  uniform mat4 u_MVPMat;\n\n  attribute vec3 POSITION; \n  attribute vec4 COLOR;\n  attribute vec2 TEXCOORD;\n  varying vec2 v_uv;\n  varying vec4 v_color;\n\n  void main() {\n    v_uv = TEXCOORD;\n    v_color = COLOR;\n    gl_Position = u_MVPMat * vec4(POSITION, 1.0);\n  }\n  ","\n  uniform sampler2D map;\n  varying vec2 v_uv;\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor = texture2D(map, v_uv) * v_color;\n  }\n");var Qt=function(t){o(r,t);var a=c(r);function r(t){var i;n(this,r),(i=a.call(this,t,e.Shader.find("spine_skeleton"))).renderState.rasterState.cullMode=e.CullMode.Off,i.renderState.depthState.writeEnabled=!1;var s=i.renderState.blendState.targetBlendState;return s.sourceColorBlendFactor=e.BlendFactor.SourceAlpha,s.destinationColorBlendFactor=e.BlendFactor.OneMinusSourceAlpha,s.sourceAlphaBlendFactor=e.BlendFactor.One,s.destinationAlphaBlendFactor=e.BlendFactor.OneMinusSourceAlpha,i.renderQueueType=e.RenderQueueType.Transparent,s.enabled=!0,i}return r}(e.Material);e.resourceLoader("spine",["json","bin"])(function(t){o(r,t);var a=c(r);function r(){return n(this,r),a.apply(this,arguments)}return i(r,[{key:"load",value:function(t,a){var n=this;return new e.AssetPromise((function(r,i){var s;"spine"!==t.type&&i("Asset type must be spine."),!t.urls&&t.url&&n.checkUrl(t.url)&&(s=n.getResouceFromUrl(t.url)),t.urls&&n.checkUrls(t.urls)&&(s=n.getResouceFromUrls(t.urls));var o,l=!1;o=new Vt((function(t){return new Jt(t,a.engine)}));var h=s,u=h.skeletonFile,c=h.atlasFile,d=h.textureFile;u&&c&&d?(o.loadText(u),o.loadText(c),o.loadTexture(d)):u&&c&&!d?(l=!0,o.loadText(u),o.loadTextureAtlas(c)):i("Resouce param error"),n.onLoad(o).then((function(t){var s;"loaded"!==t&&i(t),s=l?o.get(c):new W(o.get(c),(function(){return o.get(d)}));var h=new Nt(s),f=(n.isBinFile(u)?new jt(h):new qt(h)).readSkeletonData(o.get(u)),v=new e.Entity(a.engine),g=v.addComponent(e.MeshRenderer),m=new Qt(a.engine);g.setMaterial(m),v.addComponent(Ct).setSkeletonData(f),r(v)}))}))}},{key:"isBinFile",value:function(t){return"bin"===this.getExtFromUrl(t)}},{key:"checkUrl",value:function(t){var e=this.getExtFromUrl(t);return"json"===e||"bin"===e||(console.error("When use url as params, url must be json or bin file"),!1)}},{key:"getResouceFromUrl",value:function(t){var e=t,a=t,n=a.indexOf("?");return n>0&&(a=a.substr(0,n)),{skeletonFile:e,atlasFile:a=a.substr(0,a.lastIndexOf("."))+".atlas"}}},{key:"checkUrls",value:function(t){if(t.length<2)return console.error("When use urls as params, urls should at least contain: json/bin and atlas"),!1;if(t.length>3)return console.error("Spine runtime dont support multiple texture now"),!1;var e=this.getResouceFromUrls(t),a=e.skeletonFile,n=e.atlasFile;return e.textureFile,!(!a||!n)||(console.error("Lack ".concat(a?"":"skeletonFile").concat(n?" atlasFile":"")),!1)}},{key:"getResouceFromUrls",value:function(t){for(var e,a,n,r=0;r<t.length;r+=1){var i=t[r],s=this.getExtFromUrl(i);"json"!==s&&"bin"!==s||(e=i),"atlas"===s&&(a=i),["png","jpg","webp","jpeg"].includes(s)&&(n=i)}return{skeletonFile:e,atlasFile:a,textureFile:n}}},{key:"getExtFromUrl",value:function(t){return t.split(/[#?]/)[0].split(".").pop().trim()}},{key:"onLoad",value:function(t){return new Promise((function(e,a){setInterval((function(){t.isLoadingComplete()&&(t.hasErrors()?a(t.getErrors()):e("loaded"))}),100)}))}}]),r}(e.Loader));var Jt=function(t){o(r,t);var a=c(r);function r(t,i){var s;return n(this,r),(s=a.call(this,t)).texture=void 0,s.texture=new e.Texture2D(i,t.width,t.height),s.texture.setImageSource(t),s.texture.generateMipmaps(),s}return i(r,[{key:"setFilters",value:function(t,a){t===WebGLRenderingContext.NEAREST?this.texture.filterMode=e.TextureFilterMode.Point:a===WebGLRenderingContext.LINEAR_MIPMAP_LINEAR?this.texture.filterMode=e.TextureFilterMode.Trilinear:this.texture.filterMode=e.TextureFilterMode.Bilinear}},{key:"setWraps",value:function(t,e){this.texture.wrapModeU=t,this.texture.wrapModeV=e}},{key:"dispose",value:function(){}}]),r}(D);t.AssetManager=Vt,t.AtlasAttachmentLoader=Nt,t.SkeletonBinary=jt,t.SkeletonJson=qt,t.SpineAnimation=Ct,t.SpineMaterial=Qt,t.Texture=D,t.TextureAtlas=W,Object.defineProperty(t,"__esModule",{value:!0})}(e,a("Hd6t"))}}]);